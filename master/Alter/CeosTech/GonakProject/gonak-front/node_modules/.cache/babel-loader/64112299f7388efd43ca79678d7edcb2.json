{"ast":null,"code":"var _jsxFileName = \"/home/christopher/Documents/Alter/GonakProject/gonak-front/src/components/admin/factureRegister/factureregister.js\",\n    _s = $RefreshSig$();\n\nimport { useHistory } from \"react-router-dom\";\nimport { useState, useRef, useEffect } from \"react\";\nimport useForm from \"../../../hooks/useForm\";\nimport { sendrequest } from \"../../../middlewares/request\";\nimport ModalBootsrap from \"../../modal/Modal\";\nimport { TextField } from \"@material-ui/core\";\nimport { React } from \"react-dom\";\nimport { Button } from \"@material-ui/core\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Select from \"@material-ui/core/Select\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport axios from 'axios';\nimport { URL } from \"../../../middlewares/request\";\nimport { Alert } from \"react-alert\";\nimport \"./factureRegister.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initial = {\n  montantHT: \"\",\n  montantTVA: \"\",\n  fournisseur: \"\",\n  date_achat: \"\",\n  photo_facture: null\n};\n\nfunction FactureRegister(props) {\n  _s();\n\n  const [show, setShow] = useState(false);\n  const [success, setSuccess] = useState(false);\n\n  const handleClose = () => setShow(false);\n\n  const handleShow = () => setShow(true);\n\n  const estValide = (fieldValues = state) => {\n    const validator = {};\n    if (\"montantHT\" in fieldValues) validator.montantHT = state.montantHT ? null : \"Le champ montant est obligatore\";\n    if (\"montantTVA\" in fieldValues) validator.montantTVA = state.montantTVA ? null : \"Le champ TVA est obligatore\";\n    if (\"fournisseur\" in fieldValues) validator.fournisseur = state.fournisseur ? null : \"Le champ fournisseur est obligatore\";\n    if (\"date\" in fieldValues) validator.date_achat = state.date_achat ? null : \"Le champ date n'est pas validé\"; //   if (\"date\" in fieldValues)\n    //   validator.date = /^(([0-8][0-9])|(9[0-5]))[0-9]{3}$/.test(\n    //     code_postal\n    //   )\n    //     ? null\n    //     : \"La code date n'est pas valide\";\n\n    setErrors({ ...validator\n    }); // retourne boolean si et seulement si on passe un parametre pour la fonction\n\n    if (fieldValues === state) {\n      return Object.values(validator).every(el => !el);\n    }\n  };\n\n  const {\n    state,\n    setState,\n    handleInputChange,\n    errors,\n    setErrors,\n    reinitialiserState\n  } = useForm(initial, estValide);\n  const {\n    montantHT,\n    montantTVA,\n    fournisseur,\n    date_achat,\n    photo_facture\n  } = state;\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    console.log('state:', state);\n\n    if (estValide()) {\n      //   sendrequest(\"post\", \"comptabilite/facture/\", null, null, state).then(response => {\n      //     setSuccess(true); \n      //     handleShow();\n      //   reinitialiserState();\n      // }).catch(error => {\n      //   setSuccess(false);\n      //   handleShow();\n      //});\n      // On utilise FormData pour envoyer un fichier vers l'api, car avec sendresquest cela ne fonctionne pas vu que ça envoie un\n      let form_data = new FormData();\n      form_data.append('photo_facture', state.photo_facture, state.photo_facture.name);\n      form_data.append('montantHT', state.montantHT);\n      form_data.append('montantTVA', state.montantTVA);\n      form_data.append('fournisseur', state.fournisseur);\n      form_data.append('date_achat', state.date_achat);\n      let url = URL + \"comptabilite/facture/\";\n      axios.post(url, form_data, {\n        headers: {\n          'content-type': 'multipart/form-data'\n        }\n      }).then(res => {\n        setSuccess(true);\n        handleShow();\n        reinitialiserState();\n      }).catch(err => {\n        setSuccess(false);\n        handleShow();\n      });\n    }\n\n    ;\n  };\n\n  const history = useHistory();\n\n  const RedirectionInfo = () => {\n    let url = \"/admin/Comptabilite/\";\n    history.push(url);\n  }; // Create a reference to the hidden file input element\n\n\n  const hiddenFileInput = useRef(null); // Programatically click the hidden file input element\n  // when the Button component is clicked\n\n  const handleClick = event => {\n    hiddenFileInput.current.click();\n  }; // Call a function (passed as a prop from the parent component)\n  // to handle the user-selected file\n\n\n  const handleChange = event => {\n    const fileUploaded = event.target.files[0]; // props.handleFile(fileUploaded);\n\n    setState({ ...state,\n      photo_facture: fileUploaded\n    });\n\n    if (fileUploaded) {\n      alert(\"Vous avez inséré une image !\");\n    }\n  };\n\n  const [aujourdhui_ca, setAujourdhuiCa] = useState(null);\n  const [calendar, setCalendar] = useState(new Date().toLocaleDateString());\n  const [calendar_ca, setCalendarCa] = useState(null);\n  const aujourdhui = new Date().getTime(); //// 11/03/2021\n  //const dateFormat= \"jj/mm/aaaa\"\n\n  const get_suivi_jour = async val => {\n    setState({ ...state,\n      date_achat: val\n    });\n  };\n\n  const get_ca_by_calendar = e => {\n    // console.log(e.target.valueAsNumber);\n    // console.log(e.target.valueAsDate);\n    // console.log(new Date(e.target.valueAsNumber).toDateString()); //// Tue Mar 09 2021\n    setCalendar(new Date(e.target.valueAsNumber).getTime());\n    let tmp = new Date(e.target.valueAsNumber).getTime(); //const { debut, fin } = get_time_debut_fin(new Date(e.target.valueAsNumber));\n\n    get_suivi_jour(tmp);\n  };\n\n  const handleTVAChange = event => {\n    setState({ ...state,\n      montantTVA: event.target.value\n    });\n  }; // useEffect(() => {\n  //   console.log('state:', state)\n  // }, [state])\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"facture\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"facture-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-arrow-left\",\n        onClick: RedirectionInfo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Enregistrer une facture\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"facture_center\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \" facture_container\",\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"adresse_facture\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"facture_div\",\n            children: [/*#__PURE__*/_jsxDEV(TextField, {\n              className: \"facture_input\",\n              fullWidth: true,\n              label: \"Montant HT en euros\",\n              id: \"outlined-basic\",\n              variant: \"outlined\",\n              name: \"montantHT\",\n              value: montantHT,\n              onChange: handleInputChange,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"errors\",\n              children: errors.montantHT\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"facture_div\",\n            children: [/*#__PURE__*/_jsxDEV(FormControl, {\n              variant: \"outlined\",\n              className: \"facture_tva\",\n              children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n                id: \"demo-simple-select-outlined-label\",\n                children: \"TVA\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 202,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(Select, {\n                labelId: \"demo-simple-select-outlined-label\",\n                id: \"demo-simple-select-outlined\" //value={montantTVA}\n                ,\n                onChange: handleTVAChange,\n                label: \"Age\",\n                children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: \"\",\n                  disabled: true,\n                  children: \"Chosir TVA\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: 5.5,\n                  children: \"5.5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 213,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: 10,\n                  children: \"10\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 214,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: 20,\n                  children: \"20\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 215,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"errors\",\n              children: errors.montantTVA\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"facture_div\",\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            className: \"facture_input\",\n            fullWidth: true,\n            label: \"Fournisseur\",\n            id: \"outlined-basic\",\n            variant: \"outlined\",\n            name: \"fournisseur\",\n            value: fournisseur,\n            onChange: handleInputChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"errors\",\n            children: errors.fournisseur\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"facture_div\",\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            type: \"date\",\n            onChange: get_ca_by_calendar,\n            className: \"facture_input\",\n            fullWidth: true,\n            id: \"outlined-basic\",\n            variant: \"outlined\",\n            name: \"date_achat\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"errors\",\n            children: errors.date_achat\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"telecharger_div\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            fullWidth: true,\n            onClick: handleClick,\n            children: \"T\\xE9l\\xE9verser facture\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            ref: hiddenFileInput,\n            onChange: handleChange,\n            style: {\n              display: \"none\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"errors\",\n            children: errors.photo_facture\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"caisse_button\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"registre_facture_button\",\n            type: \"submit\",\n            children: \"Valider\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(ModalBootsrap, {\n          handleClose: handleClose,\n          show: show,\n          title: /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [success ? \"Envoyé\" : \"Oups\", /*#__PURE__*/_jsxDEV(\"i\", {\n              className: `${success ? \" fas fa-thumbs-up\" : \" fas fa-thumbs-down\"}`,\n              style: {\n                color: \"#4caf50\",\n                marginLeft: \"1rem\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true),\n          children: success ? \"Enregistrement avec succès.\" : \"Une erreur s'est produite, veuillez réessayer.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 176,\n    columnNumber: 5\n  }, this);\n}\n\n_s(FactureRegister, \"OBme1cXtrBgnKqrxVrKVaOGtCPI=\", false, function () {\n  return [useForm, useHistory];\n});\n\n_c = FactureRegister;\nexport default FactureRegister;\n\nvar _c;\n\n$RefreshReg$(_c, \"FactureRegister\");","map":{"version":3,"sources":["/home/christopher/Documents/Alter/GonakProject/gonak-front/src/components/admin/factureRegister/factureregister.js"],"names":["useHistory","useState","useRef","useEffect","useForm","sendrequest","ModalBootsrap","TextField","React","Button","FormControl","Select","InputLabel","MenuItem","axios","URL","Alert","initial","montantHT","montantTVA","fournisseur","date_achat","photo_facture","FactureRegister","props","show","setShow","success","setSuccess","handleClose","handleShow","estValide","fieldValues","state","validator","setErrors","Object","values","every","el","setState","handleInputChange","errors","reinitialiserState","handleSubmit","e","preventDefault","console","log","form_data","FormData","append","name","url","post","headers","then","res","catch","err","history","RedirectionInfo","push","hiddenFileInput","handleClick","event","current","click","handleChange","fileUploaded","target","files","alert","aujourdhui_ca","setAujourdhuiCa","calendar","setCalendar","Date","toLocaleDateString","calendar_ca","setCalendarCa","aujourdhui","getTime","get_suivi_jour","val","get_ca_by_calendar","valueAsNumber","tmp","handleTVAChange","value","display","color","marginLeft"],"mappings":"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","sourcesContent":["import { useHistory } from \"react-router-dom\";\nimport { useState, useRef, useEffect } from \"react\";\nimport useForm from \"../../../hooks/useForm\";\nimport { sendrequest } from \"../../../middlewares/request\";\nimport ModalBootsrap from \"../../modal/Modal\";\nimport { TextField } from \"@material-ui/core\";\nimport { React } from \"react-dom\";\nimport { Button } from \"@material-ui/core\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Select from \"@material-ui/core/Select\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport axios from 'axios';\nimport {URL} from \"../../../middlewares/request\";\nimport { Alert } from \"react-alert\";\n\n\nimport \"./factureRegister.css\";\n\nconst initial = {\n  montantHT: \"\",\n  montantTVA: \"\",\n  fournisseur: \"\",\n  date_achat: \"\",\n  photo_facture: null,\n};\n\nfunction FactureRegister(props) {\n  const [show, setShow] = useState(false);\n  const [success, setSuccess] = useState(false);\n\n  const handleClose = () => setShow(false);\n  const handleShow = () => setShow(true);\n\n  const estValide = (fieldValues = state) => {\n    const validator = {};\n\n    if (\"montantHT\" in fieldValues)\n      validator.montantHT = state.montantHT\n        ? null\n        : \"Le champ montant est obligatore\";\n\n    if (\"montantTVA\" in fieldValues)\n      validator.montantTVA = state.montantTVA ? null : \"Le champ TVA est obligatore\";\n\n    if (\"fournisseur\" in fieldValues)\n      validator.fournisseur = state.fournisseur\n        ? null\n        : \"Le champ fournisseur est obligatore\";\n\n    if (\"date\" in fieldValues)\n      validator.date_achat = state.date_achat ? null : \"Le champ date n'est pas validé\";\n\n    //   if (\"date\" in fieldValues)\n    //   validator.date = /^(([0-8][0-9])|(9[0-5]))[0-9]{3}$/.test(\n    //     code_postal\n    //   )\n    //     ? null\n    //     : \"La code date n'est pas valide\";\n\n    setErrors({ ...validator });\n\n    // retourne boolean si et seulement si on passe un parametre pour la fonction\n    if (fieldValues === state) {\n      return Object.values(validator).every((el) => !el);\n    }\n  };\n\n  const { state, setState, handleInputChange, errors, setErrors, reinitialiserState } =\n    useForm(initial, estValide);\n\n  const { montantHT, montantTVA, fournisseur, date_achat, photo_facture } = state;\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    console.log('state:', state)\n    if (estValide()){\n    //   sendrequest(\"post\", \"comptabilite/facture/\", null, null, state).then(response => {\n    //     setSuccess(true); \n    //     handleShow();\n    //   reinitialiserState();\n    // }).catch(error => {\n    //   setSuccess(false);\n    //   handleShow();\n    //});\n    \n\n    // On utilise FormData pour envoyer un fichier vers l'api, car avec sendresquest cela ne fonctionne pas vu que ça envoie un\n    let form_data = new FormData();\n    form_data.append('photo_facture', state.photo_facture, state.photo_facture.name);\n    form_data.append('montantHT', state.montantHT);\n    form_data.append('montantTVA', state.montantTVA);\n    form_data.append('fournisseur', state.fournisseur);\n    form_data.append('date_achat', state.date_achat);\n    let url = URL+\"comptabilite/facture/\";\n\n    axios.post(url, form_data, {\n      headers: {\n        'content-type': 'multipart/form-data'\n      }\n    })\n        .then(res => {\n          setSuccess(true); \n          handleShow();\n         reinitialiserState();\n        })\n        .catch(err => {\n          setSuccess(false);\n          handleShow();\n        })\n  };\n\n    \n  };\n\n  const history = useHistory();\n\n  const RedirectionInfo = () => {\n    let url = \"/admin/Comptabilite/\";\n    history.push(url);\n  };\n  // Create a reference to the hidden file input element\n  const hiddenFileInput = useRef(null);\n\n  // Programatically click the hidden file input element\n  // when the Button component is clicked\n  const handleClick = (event) => {\n    hiddenFileInput.current.click();\n  };\n  // Call a function (passed as a prop from the parent component)\n  // to handle the user-selected file\n  const handleChange = (event) => {\n    const fileUploaded = event.target.files[0];\n    // props.handleFile(fileUploaded);\n    setState({...state,photo_facture:fileUploaded})\n    if (fileUploaded){\n      alert(\"Vous avez inséré une image !\")\n    }\n  };\n\n  const [aujourdhui_ca, setAujourdhuiCa] = useState(null);\n  const [calendar, setCalendar] = useState(new Date().toLocaleDateString());\n  const [calendar_ca, setCalendarCa] = useState(null);\n\n  const aujourdhui = new Date().getTime(); //// 11/03/2021\n\n  //const dateFormat= \"jj/mm/aaaa\"\n\n  const get_suivi_jour = async (val) => {\n    setState({...state, date_achat:val})\n  };\n\n\n  const get_ca_by_calendar = (e) => {\n    // console.log(e.target.valueAsNumber);\n    // console.log(e.target.valueAsDate);\n    // console.log(new Date(e.target.valueAsNumber).toDateString()); //// Tue Mar 09 2021\n\n    setCalendar(new Date(e.target.valueAsNumber).getTime());\n    let tmp = new Date(e.target.valueAsNumber).getTime()\n    //const { debut, fin } = get_time_debut_fin(new Date(e.target.valueAsNumber));\n    get_suivi_jour(tmp);\n  };\n\n  const handleTVAChange=(event)=>{\n    setState({...state,montantTVA:event.target.value})\n  }\n\n  // useEffect(() => {\n  //   console.log('state:', state)\n   \n  // }, [state])\n\n  return (\n    \n    <div className=\"facture\">\n      <div className=\"facture-header\">\n        <i className=\"fas fa-arrow-left\" onClick={RedirectionInfo}></i>\n        <h1>Enregistrer une facture</h1>\n      </div>\n\n      <div className=\"facture_center\" >\n      <form className=\" facture_container\" onSubmit={handleSubmit}>\n        <div className=\"adresse_facture\">\n          <div className=\"facture_div\">\n            <TextField\n              className=\"facture_input\"\n              fullWidth\n              label=\"Montant HT en euros\"\n              id=\"outlined-basic\"\n              variant=\"outlined\"\n              name=\"montantHT\"\n              value={montantHT}\n              onChange={handleInputChange}\n              required\n            />\n            <div className=\"errors\">{errors.montantHT}</div>\n          </div>\n\n          <div className=\"facture_div\">\n            <FormControl variant=\"outlined\" className=\"facture_tva\">\n              <InputLabel id=\"demo-simple-select-outlined-label\">\n                TVA\n              </InputLabel>\n              <Select\n                labelId=\"demo-simple-select-outlined-label\"\n                id=\"demo-simple-select-outlined\"\n                //value={montantTVA}\n                onChange={handleTVAChange}\n                label=\"Age\"\n              >\n                <MenuItem value=\"\" disabled>Chosir TVA</MenuItem>\n                <MenuItem value={5.5}>5.5</MenuItem>\n                <MenuItem value={10}>10</MenuItem>\n                <MenuItem value={20}>20</MenuItem>\n              </Select>\n            </FormControl>\n            <div className=\"errors\">{errors.montantTVA}</div>\n          </div>\n        </div>\n\n        <div className=\"facture_div\">\n          <TextField\n            className=\"facture_input\"\n            fullWidth\n            label=\"Fournisseur\"\n            id=\"outlined-basic\"\n            variant=\"outlined\"\n            name=\"fournisseur\"\n            value={fournisseur}\n            onChange={handleInputChange}\n            required\n          />\n          <div className=\"errors\">{errors.fournisseur}</div>\n        </div>\n\n        <div className=\"facture_div\">\n          {/* <TextField\n            className=\"facture_input\"\n            fullWidth\n            id=\"outlined-basic\"\n            variant=\"outlined\"\n            name=\"date_achat\"\n            type=\"date\"\n            value={date_achat}\n            onChange={handleInputChange}\n            required\n          /> */}\n          <TextField type='date' onChange={get_ca_by_calendar} \n          className=\"facture_input\"\n          fullWidth\n          id=\"outlined-basic\"\n          variant=\"outlined\"\n          name=\"date_achat\"\n          required/>\n          <div className=\"errors\">{errors.date_achat}</div>\n        </div>\n\n        <div className=\"telecharger_div\">\n          <Button fullWidth onClick={handleClick}>\n            Téléverser facture\n          </Button>\n          <input\n            type=\"file\"\n            ref={hiddenFileInput}\n            onChange={handleChange}\n            style={{ display: \"none\" }}\n          />\n          <div className=\"errors\">{errors.photo_facture}</div>\n        </div>\n\n        <div className=\"caisse_button\">\n          <button className=\"registre_facture_button\" type=\"submit\">\n            Valider\n          </button>\n        </div>\n\n        <ModalBootsrap\n          handleClose={handleClose}\n          show={show}\n          title={\n            <>\n              {success ? \"Envoyé\" : \"Oups\"}\n              <i\n                className={`${\n                  success ? \" fas fa-thumbs-up\" : \" fas fa-thumbs-down\"\n                }`}\n                style={{ color: \"#4caf50\", marginLeft: \"1rem\" }}\n              ></i>\n            </>\n          }\n        >\n          {success\n            ? \"Enregistrement avec succès.\"\n            : \"Une erreur s'est produite, veuillez réessayer.\"}\n        </ModalBootsrap>\n      </form>\n      </div>\n    </div>\n    \n  );\n}\nexport default FactureRegister;\n"]},"metadata":{},"sourceType":"module"}