{"ast":null,"code":"import _regeneratorRuntime from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import ProductList from\"../product/ProductList\";import{URL}from\"../../../middlewares/request\";import{changenouvelleCommandeLength,changeCommandeCoursLength,selectAdmin,changePage}from\"../../../app/Redux-slices/adminSlice\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CommandeEnCours=function CommandeEnCours(){var admin=useSelector(selectAdmin);var dispatch=useDispatch();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),commandes=_useState2[0],setCommandes=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),nouvellesCommandes=_useState4[0],setNouvellesCommandes=_useState4[1];var fetchCommandes=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(URL+\"paiement/commande-encours\");case 2:_yield$axios$get=_context.sent;data=_yield$axios$get.data;setCommandes(data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchCommandes(){return _ref.apply(this,arguments);};}();var fetchNouvellesCommandes=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$axios$get2,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(URL+\"paiement/nouvelle-commande\");case 2:_yield$axios$get2=_context2.sent;data=_yield$axios$get2.data;setNouvellesCommandes(data);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchNouvellesCommandes(){return _ref2.apply(this,arguments);};}();useEffect(function(){// a chaque fois que commande change, on met a jour la longueur de nouvelle commande\ndispatch(changenouvelleCommandeLength(nouvellesCommandes.length));},[nouvellesCommandes,dispatch]);useEffect(function(){// a chaque fois que commande change, on met a jour la longueur de nouvelle commande\ndispatch(changeCommandeCoursLength(commandes.length));},[commandes,dispatch]);useEffect(function(){fetchCommandes();var timeoutId;function getLatestCommandes(){fetchNouvellesCommandes();// wait for the response from fetchCommandes , before we recall it (delay of 1minute)\ntimeoutId=setTimeout(getLatestCommandes,1000*60);}getLatestCommandes();return function(){clearTimeout(timeoutId);setCommandes([]);setNouvellesCommandes([]);};},[]);var commande_est_livre=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.put(URL+\"paiement/update-commande\",{id:id,est_livre:true});case 2:fetchCommandes();case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function commande_est_livre(_x){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"commande-en-cours admin__container\",children:[/*#__PURE__*/_jsx(\"h1\",{style:{textAlign:\"center\",marginBottom:\"2rem\",color:\"#04295D\"},children:commandes.length?\"Vos Commandes en cours\":\"Pas de Commandes en cours\"}),/*#__PURE__*/_jsx(ProductList,{commandes:commandes,action:commande_est_livre,btn:\"Remise au client\",btnImprimer:\"Imprimer facture\",estPrisConnaissance:true})]});};export default CommandeEnCours;","map":{"version":3,"sources":["/home/christopher/Documents/Alter/GonakProject/gonak-front/src/components/admin/commandeEnCours/CommandeEnCours.js"],"names":["axios","useEffect","useState","useDispatch","useSelector","ProductList","URL","changenouvelleCommandeLength","changeCommandeCoursLength","selectAdmin","changePage","CommandeEnCours","admin","dispatch","commandes","setCommandes","nouvellesCommandes","setNouvellesCommandes","fetchCommandes","get","data","fetchNouvellesCommandes","length","timeoutId","getLatestCommandes","setTimeout","clearTimeout","commande_est_livre","id","put","est_livre","textAlign","marginBottom","color"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport ProductList from \"../product/ProductList\";\nimport {URL} from \"../../../middlewares/request\";\nimport {\n        changenouvelleCommandeLength,\n        changeCommandeCoursLength,\n        selectAdmin,\n        changePage\n    } from \"../../../app/Redux-slices/adminSlice\";\n\nconst CommandeEnCours = () => {\n  const admin = useSelector(selectAdmin);\n  const dispatch = useDispatch();\n  const [commandes, setCommandes] = useState([]);\n  const [nouvellesCommandes, setNouvellesCommandes] = useState([]);\n\n  const fetchCommandes = async () => {\n    const { data } = await axios.get(\n      URL+\"paiement/commande-encours\",\n    );\n    setCommandes(data);\n  };\n\n  const fetchNouvellesCommandes = async () => {\n    const { data } = await axios.get(\n      URL+\"paiement/nouvelle-commande\"\n    );\n    setNouvellesCommandes(data);\n  };\n\n  useEffect(() => {\n    // a chaque fois que commande change, on met a jour la longueur de nouvelle commande\n    dispatch(changenouvelleCommandeLength(nouvellesCommandes.length));\n  }, [nouvellesCommandes, dispatch]);\n\n  useEffect(() => {\n    // a chaque fois que commande change, on met a jour la longueur de nouvelle commande\n    dispatch(changeCommandeCoursLength(commandes.length));\n  }, [commandes, dispatch]);\n\n  useEffect(() => {\n    fetchCommandes();\n    let timeoutId;\n    function getLatestCommandes() {\n      fetchNouvellesCommandes();\n\n      // wait for the response from fetchCommandes , before we recall it (delay of 1minute)\n      timeoutId = setTimeout(getLatestCommandes, 1000 * 60);\n    }\n    getLatestCommandes();\n\n    return () => {\n      clearTimeout(timeoutId);\n      setCommandes([]);\n      setNouvellesCommandes([]);\n    };\n  }, []);\n\n\n  const commande_est_livre = async (id) => {\n    await axios.put(URL+\"paiement/update-commande\", {\n      id,\n      est_livre: true,\n    });\n\n    fetchCommandes();\n  };\n\n  return (\n    <div className='commande-en-cours admin__container'>\n      <h1\n        style={{\n          textAlign: \"center\",\n          marginBottom: \"2rem\",\n          color: \"#04295D\",\n        }}>\n        {commandes.length ? \"Vos Commandes en cours\" : \"Pas de Commandes en cours\"}\n      </h1>\n      <ProductList\n        commandes={commandes}\n        action={commande_est_livre}\n        btn={\"Remise au client\"}\n        btnImprimer={\"Imprimer facture\"}\n        estPrisConnaissance\n      />\n    </div>\n  );\n};\n\nexport default CommandeEnCours;\n"]},"metadata":{},"sourceType":"module"}