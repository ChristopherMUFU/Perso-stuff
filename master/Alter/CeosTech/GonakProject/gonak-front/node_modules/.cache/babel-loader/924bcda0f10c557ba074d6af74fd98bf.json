{"ast":null,"code":"import _objectSpread from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useHistory}from\"react-router-dom\";import{useState}from\"react\";import useForm from\"../../../hooks/useForm\";import{sendrequest,URL}from\"../../../middlewares/request\";import ModalBootsrap from\"../modal/Modal\";import{TextField}from'@material-ui/core';import{Button}from'@material-ui/core';import'./caisse.css';import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UpdateFormCaisse=function UpdateFormCaisse(_ref){var restaurantOwner=_ref.restaurantOwner;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),success=_useState4[0],setSuccess=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),initState=_useState6[0],setInitState=_useState6[1];var handleClose=function handleClose(){return setShow(false);};var handleShow=function handleShow(){return setShow(true);};var token=window.$token_access;var email=window.$email_dirigeant;var password_dir=window.$password_dirigeant;var updateData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.put(URL+\"accounts/restaurantowner/\"+restaurantOwner.id+\"/\",{nom:restaurantOwner.nom,prénom:restaurantOwner.prénom,email:restaurantOwner.email,phone_number:restaurantOwner.phone_number,company_position:restaurantOwner.company_position,restaurant:{name:restaurantOwner.restaurant.name,address:restaurantOwner.restaurant.address,postal_code:restaurantOwner.restaurant.postal_code,city:restaurantOwner.restaurant.city,phone_number:restaurantOwner.restaurant.phone_number},company:{name:restaurantOwner.company.name,address:restaurantOwner.company.address,postal_code:restaurantOwner.company.postal_code,city:restaurantOwner.company.city,capital:restaurantOwner.company.capital,SIRET_number:restaurantOwner.company.SIRET_number,retirement_fund_name:state.denomination,retirement_fund_address:state.adresse,retirement_fund_city:state.ville,retirement_fund_postal_code:state.code_postal},user:{//username: state.adresse_mail,\nemail:state.adresse_mail,password:password_dir}},{headers:{'Authorization':\"Bearer \".concat(token)}}).then(function(result){console.log(result.data);});case 2:res=_context.sent;case 3:case\"end\":return _context.stop();}}},_callee);}));return function updateData(){return _ref2.apply(this,arguments);};}();var estValide=function estValide(){var fieldValues=arguments.length>0&&arguments[0]!==undefined?arguments[0]:state;var validator={};if(\"denomination\"in fieldValues)validator.denomination=state.denomination?null:\"Le champ dénomination est obligatore\";if(\"adresse\"in fieldValues)validator.denomination=state.denomination?null:\"Le champ adresse est obligatore\";if(\"ville\"in fieldValues)validator.ville=state.ville?null:\"Le champ ville est obligatore\";if(\"code_postal\"in fieldValues)validator.code_postal=/^(([0-8][0-9])|(9[0-5]))[0-9]{3}$/.test(code_postal)?null:\"Le code postal n'est pas valide\";setErrors(_objectSpread({},validator));// retourne boolean si et seulement si on passe un parametre pour la fonction\nif(fieldValues===state){return Object.values(validator).every(function(el){return!el;});}};var _useForm=useForm(initState,estValide),state=_useForm.state,handleInputChange=_useForm.handleInputChange,errors=_useForm.errors,setErrors=_useForm.setErrors,reinitialiserState=_useForm.reinitialiserState;var denomination=state.denomination,code_postal=state.code_postal,ville=state.ville,adresse=state.adresse;//state.prenom = restaurantOwner.prénom\n//Fonction permettant d'afficher les données récupérés\n//contenant => input modifiable\n//contenue => donnée à afficher\nvar preAffichage=function preAffichage(contenant){if(contenant===undefined){state.denomination=restaurantOwner.company.retirement_fund_name;state.code_postal=restaurantOwner.company.retirement_fund_postal_code;state.ville=restaurantOwner.company.retirement_fund_city;state.adresse=restaurantOwner.company.retirement_fund_address;console.log(contenant);return state.denomination+\"\";}return contenant+\"\";};var handleSubmit=function handleSubmit(e){e.preventDefault();if(restaurantOwner===[]){//reinitialiserState();\nif(estValide()){sendrequest(\"put\",\"main/caisse/\",null,null,state).then(function(response){if(response!==false&&estValide()){setSuccess(true);handleShow();}else{setSuccess(false);handleShow();}});}}else{updateData();setSuccess(true);handleShow();}};var history=useHistory();var RedirectionInfo=function RedirectionInfo(){var url=\"/admin/mon-compte/infos-personnelles\";history.push(url);};return/*#__PURE__*/_jsx(_Fragment,{children:restaurantOwner!==undefined&&restaurantOwner.restaurant!==undefined?/*#__PURE__*/_jsxs(\"form\",{className:\" caisse_container\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"caisse_div\",children:[/*#__PURE__*/_jsx(TextField,{className:\"caisse_input\",fullWidth:true,label:\"D\\xE9nomination social\",id:\"outlined-basic\",variant:\"outlined\",name:\"denomination\",value:preAffichage(state.denomination),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.denomination})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"caisse_div\",children:[/*#__PURE__*/_jsx(TextField,{className:\"caisse_input\",fullWidth:true,label:\"Adresse\",id:\"outlined-basic\",variant:\"outlined\",name:\"adresse\",value:preAffichage(state.adresse),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.adresse})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"adresse_caisse\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"caisse_div\",children:[/*#__PURE__*/_jsx(TextField,{className:\"caisse_input\",fullWidth:true,label:\"Code Postal\",id:\"outlined-basic\",variant:\"outlined\",name:\"code_postal\",value:preAffichage(state.code_postal),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.code_postal})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"caisse_div\",children:[/*#__PURE__*/_jsx(TextField,{className:\"caisse_input\",fullWidth:true,label:\"Ville\",id:\"outlined-basic\",variant:\"outlined\",name:\"ville\",value:preAffichage(state.ville),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.ville})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"caisse_button\",children:/*#__PURE__*/_jsx(\"button\",{className:\"registre_caisse_button\",type:\"submit\",children:\"Enregistrer\"})}),/*#__PURE__*/_jsx(ModalBootsrap,{handleClose:handleClose,show:show,title:/*#__PURE__*/_jsxs(_Fragment,{children:[success?\"Envoyé\":\"Oups\",/*#__PURE__*/_jsx(\"i\",{className:\"\".concat(success?\" fas fa-thumbs-up\":\" fas fa-thumbs-down\"),style:{color:\"#4caf50\",marginLeft:\"1rem\"}})]}),children:success?\"Enregistrement avec succès.\":\"Une erreur s'est produite, veuillez réessayer.\"})]}):null});};export default UpdateFormCaisse;","map":{"version":3,"sources":["/home/christopher/Documents/Alter/GonakProject/gonak-front/src/components/admin/caisse/UpdateFormCaisse.js"],"names":["useHistory","useState","useForm","sendrequest","URL","ModalBootsrap","TextField","Button","axios","UpdateFormCaisse","restaurantOwner","show","setShow","success","setSuccess","initState","setInitState","handleClose","handleShow","token","window","$token_access","email","$email_dirigeant","password_dir","$password_dirigeant","updateData","put","id","nom","prénom","phone_number","company_position","restaurant","name","address","postal_code","city","company","capital","SIRET_number","retirement_fund_name","state","denomination","retirement_fund_address","adresse","retirement_fund_city","ville","retirement_fund_postal_code","code_postal","user","adresse_mail","password","headers","then","result","console","log","data","res","estValide","fieldValues","validator","test","setErrors","Object","values","every","el","handleInputChange","errors","reinitialiserState","preAffichage","contenant","undefined","handleSubmit","e","preventDefault","response","history","RedirectionInfo","url","push","color","marginLeft"],"mappings":"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","sourcesContent":["import { useHistory } from \"react-router-dom\";\nimport  { useState } from \"react\";\nimport useForm from \"../../../hooks/useForm\";\n import {sendrequest, URL} from \"../../../middlewares/request\"\nimport ModalBootsrap from \"../modal/Modal\";\nimport {TextField} from '@material-ui/core';\nimport {Button} from '@material-ui/core';\n\nimport './caisse.css'\nimport axios from \"axios\";\n\n\n\nconst UpdateFormCaisse = ({restaurantOwner}) =>{\n\n\n    const [show, setShow] = useState(false);\n    const [success, setSuccess] = useState(false);\n    const [initState, setInitState] = useState([]);\n\n    const handleClose = () => setShow(false);\n    const handleShow = () => setShow(true);\n\n     const token = window.$token_access;\n    const email = window.$email_dirigeant;\n    const password_dir = window.$password_dirigeant;\n\n    const updateData = async () => {\n       const res = await axios.put(\n                URL + \"accounts/restaurantowner/\" + restaurantOwner.id + \"/\"\n            ,{\n                nom: restaurantOwner.nom,\n                prénom: restaurantOwner.prénom,\n                email: restaurantOwner.email,\n                phone_number: restaurantOwner.phone_number,\n                company_position: restaurantOwner.company_position,\n                restaurant: {\n                    name: restaurantOwner.restaurant.name,\n                    address: restaurantOwner.restaurant.address,\n                    postal_code: restaurantOwner.restaurant.postal_code,\n                    city: restaurantOwner.restaurant.city,\n                    phone_number: restaurantOwner.restaurant.phone_number\n                },\n                company: {\n                    name: restaurantOwner.company.name,\n                    address: restaurantOwner.company.address,\n                    postal_code: restaurantOwner.company.postal_code,\n                    city: restaurantOwner.company.city,\n                    capital: restaurantOwner.company.capital,\n                    SIRET_number: restaurantOwner.company.SIRET_number,\n\n                    retirement_fund_name: state.denomination,\n                    retirement_fund_address: state.adresse,\n                    retirement_fund_city: state.ville,\n                    retirement_fund_postal_code: state.code_postal\n                },\n                user: {\n                    //username: state.adresse_mail,\n                    email: state.adresse_mail,\n                    password: password_dir\n                }\n            },\n            {\n                headers: {\n                    'Authorization': `Bearer ${token}`\n                }\n            }\n      ).then((result) => {console.log(result.data)});\n\n      //console.log(res.data);\n\n    }\n\n      const estValide = (fieldValues = state) => {\n      const validator = {};\n\n      if (\"denomination\" in fieldValues)\n        validator.denomination = state.denomination ? null : \"Le champ dénomination est obligatore\";\n\n      if (\"adresse\" in fieldValues)\n        validator.denomination = state.denomination ? null : \"Le champ adresse est obligatore\";\n\n      if (\"ville\" in fieldValues)\n        validator.ville = state.ville ? null : \"Le champ ville est obligatore\";\n\n      if (\"code_postal\" in fieldValues)\n      validator.code_postal = /^(([0-8][0-9])|(9[0-5]))[0-9]{3}$/.test(\n        code_postal\n      )\n        ? null\n        : \"Le code postal n'est pas valide\";\n\n\n      setErrors({ ...validator });\n\n      // retourne boolean si et seulement si on passe un parametre pour la fonction\n      if (fieldValues === state) {\n        return Object.values(validator).every((el) => !el);\n      }\n    };\n\n      const {\n      state,\n      handleInputChange,\n      errors,\n      setErrors,\n      reinitialiserState,\n    } = useForm(initState, estValide);\n\n    const {denomination, code_postal, ville, adresse } = state\n\n\n    //state.prenom = restaurantOwner.prénom\n    //Fonction permettant d'afficher les données récupérés\n    //contenant => input modifiable\n    //contenue => donnée à afficher\n    const preAffichage = (contenant) => {\n        if(contenant === undefined){\n            state.denomination = restaurantOwner.company.retirement_fund_name\n            state.code_postal = restaurantOwner.company.retirement_fund_postal_code\n            state.ville = restaurantOwner.company.retirement_fund_city\n            state.adresse = restaurantOwner.company.retirement_fund_address\n\n\n            console.log(contenant)\n            return state.denomination + \"\"\n        }\n        return contenant + \"\"\n\n    }\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n\n\n        if(restaurantOwner === []){\n            //reinitialiserState();\n            if (estValide()) {\n                sendrequest(\"put\", \"main/caisse/\", null, null, state)\n                .then((response) => {\n                    if (response !== false && estValide()) {\n                        setSuccess(true);\n                        handleShow();\n                    } else {\n                        setSuccess(false);\n                        handleShow();\n                    }\n                })\n            }\n        }\n        else{\n            updateData();\n            setSuccess(true);\n            handleShow();\n        }\n    };\n\n\n    const history = useHistory();\n\n    const RedirectionInfo = () =>{\n      let url = \"/admin/mon-compte/infos-personnelles\";\n      history.push(url);\n    }\n\n  return (\n\n        <>\n                    {restaurantOwner !== undefined && restaurantOwner.restaurant !== undefined ?\n                             <form className=' caisse_container' onSubmit={handleSubmit}>\n                                 <div className=\"caisse_div\">\n                                    <TextField\n                                    className='caisse_input'\n                                    fullWidth\n                                    label =\"Dénomination social\"\n                                    id=\"outlined-basic\"\n                                    variant=\"outlined\"\n                                    name=\"denomination\"\n                                    value={preAffichage(state.denomination)}\n                                    onChange={handleInputChange}\n                                    required/>\n                                    <div className=\"errors\">{errors.denomination}</div>\n                                 </div>\n                                 <div className=\"caisse_div\">\n                                     <TextField\n                                     className='caisse_input'\n                                     fullWidth\n                                     label =\"Adresse\"\n                                     id=\"outlined-basic\"\n                                     variant=\"outlined\"\n                                      name=\"adresse\"\n                                      value={preAffichage(state.adresse)}\n                                      onChange={handleInputChange}\n                                      required/>\n                                     <div className=\"errors\">{errors.adresse}</div>\n                                </div>\n                                <div className='adresse_caisse'>\n                                 <div className=\"caisse_div\">\n                                     <TextField\n                                     className='caisse_input'\n                                     fullWidth\n                                     label =\"Code Postal\"\n                                     id=\"outlined-basic\"\n                                     variant=\"outlined\"\n                                     name=\"code_postal\"\n                                     value={preAffichage(state.code_postal)}\n                                     onChange={handleInputChange}\n                                     required/>\n                                     <div className=\"errors\">{errors.code_postal}</div>\n                                </div>\n                                 <div className=\"caisse_div\">\n                                     <TextField\n                                     className='caisse_input'\n                                     fullWidth\n                                     label =\"Ville\"\n                                     id=\"outlined-basic\"\n                                     variant=\"outlined\"\n                                     name=\"ville\"\n                                     value={preAffichage(state.ville)}\n                                     onChange={handleInputChange}\n                                     required/>\n                                     <div className=\"errors\">{errors.ville}</div>\n                                </div>\n                                </div>\n                                <div className='caisse_button'>\n                                    <button className=\"registre_caisse_button\" type=\"submit\">Enregistrer</button>\n\n                                </div>\n\n                                <ModalBootsrap\n                                    handleClose={handleClose}\n                                    show={show}\n                                    title={\n                                        <>\n                                            {success ? \"Envoyé\" : \"Oups\"}\n                                            <i\n                                                className={\n                                                    `${success ? \" fas fa-thumbs-up\" : \" fas fa-thumbs-down\"}`}\n                                                style={{color: \"#4caf50\", marginLeft: \"1rem\"}}></i>\n                                        </>\n                                    }>\n                                    {success ? \"Enregistrement avec succès.\" : \"Une erreur s'est produite, veuillez réessayer.\"}\n                                </ModalBootsrap>\n\n                             </form>\n                        :null}\n                </>\n\n\n\n);\n\n}\nexport default UpdateFormCaisse;\n"]},"metadata":{},"sourceType":"module"}