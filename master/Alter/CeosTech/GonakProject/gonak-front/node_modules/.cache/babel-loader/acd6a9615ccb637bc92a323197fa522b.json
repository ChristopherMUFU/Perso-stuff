{"ast":null,"code":"import _regeneratorRuntime from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import{useEffect,useState/*, useRef*/}from\"react\";import{useDispatch}from\"react-redux\";import{changenouvelleCommandeLength,changeCommandeCoursLength}from\"../../../app/Redux-slices/adminSlice\";import ProductList from\"../product/ProductList\";import{URL}from\"../../../middlewares/request\";//import ReactStopwatch from 'react-stopwatch';\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NouvelleCommande=function NouvelleCommande(){var dispatch=useDispatch();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),commandes=_useState2[0],setCommandes=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),commandesEnCours=_useState4[0],setCommandesEnCours=_useState4[1];// const [running, setRunning] = useState(false);\n// const [currentTimeMin, setCurrentTimeMin] = useState(0);\nvar fetchCommandes=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(URL+\"paiement/nouvelle-commande\");case 2:_yield$axios$get=_context.sent;data=_yield$axios$get.data;setCommandes(data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchCommandes(){return _ref.apply(this,arguments);};}();var fetchCommandesEnCours=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$axios$get2,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(URL+\"paiement/commande-encours\");case 2:_yield$axios$get2=_context2.sent;data=_yield$axios$get2.data;setCommandesEnCours(data);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchCommandesEnCours(){return _ref2.apply(this,arguments);};}();useEffect(function(){// console.log(\"Commande: \",commandes)\n// a chaque fois que commande change, on met a jour la longueur de nouvelle commande\ndispatch(changenouvelleCommandeLength(commandes.length));},[commandes,dispatch]);useEffect(function(){// a chaque fois que commande change, on met a jour la longueur de nouvelle commande\ndispatch(changeCommandeCoursLength(commandesEnCours.length));},[commandesEnCours,dispatch]);useEffect(function(){fetchCommandesEnCours();var timeoutId;function getLatestCommandes(){fetchCommandes();// wait for the response from fetchCommandes , before we recall it (delay of 1minute)\ntimeoutId=setTimeout(getLatestCommandes,1000*60);}getLatestCommandes();return function(){clearTimeout(timeoutId);setCommandes([]);};},[]);var commande_est_vue=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.put(URL+\"paiement/update-commande\",{id:id,est_vue:true});case 2:fetchCommandes();fetchCommandesEnCours();case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function commande_est_vue(_x){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"nouvelleCommande admin__container\",children:[/*#__PURE__*/_jsx(\"h1\",{style:{textAlign:\"center\",marginBottom:\"2rem\",color:\"#04295d\"},children:commandes.length?\"Vos Nouvelles Commandes\":\"Pas de Nouvelles commandes\"}),/*#__PURE__*/_jsx(ProductList,{nouvelleCommande:true,commandes:commandes,action:commande_est_vue,btn:\"confirmer\"})]});};export default NouvelleCommande;","map":{"version":3,"sources":["/home/christopher/Documents/Alter/GonakProject/gonak-front/src/components/admin/nouvelleCommande/NouvelleCommande.js"],"names":["axios","useEffect","useState","useDispatch","changenouvelleCommandeLength","changeCommandeCoursLength","ProductList","URL","NouvelleCommande","dispatch","commandes","setCommandes","commandesEnCours","setCommandesEnCours","fetchCommandes","get","data","fetchCommandesEnCours","length","timeoutId","getLatestCommandes","setTimeout","clearTimeout","commande_est_vue","id","put","est_vue","textAlign","marginBottom","color"],"mappings":"ghBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,CAAoBC,QAAS,YAA7B,KAAiD,OAAjD,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OACEC,4BADF,CAEEC,yBAFF,KAGO,sCAHP,CAIA,MAAOC,CAAAA,WAAP,KAAwB,wBAAxB,CACA,OAASC,GAAT,KAAoB,8BAApB,CACA;wFAEA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAC7B,GAAMC,CAAAA,QAAQ,CAAGN,WAAW,EAA5B,CACA,cAAkCD,QAAQ,CAAC,EAAD,CAA1C,wCAAOQ,SAAP,eAAkBC,YAAlB,eACA,eAAgDT,QAAQ,CAAC,EAAD,CAAxD,yCAAOU,gBAAP,eAAyBC,mBAAzB,eACA;AACA;AAEA,GAAMC,CAAAA,cAAc,0FAAG,mLACEd,CAAAA,KAAK,CAACe,GAAN,CAAUR,GAAG,CAAG,4BAAhB,CADF,uCACbS,IADa,kBACbA,IADa,CAErBL,YAAY,CAACK,IAAD,CAAZ,CAFqB,sDAAH,kBAAdF,CAAAA,cAAc,0CAApB,CAKA,GAAMG,CAAAA,qBAAqB,2FAAG,0LACLjB,CAAAA,KAAK,CAACe,GAAN,CAAUR,GAAG,CAAG,2BAAhB,CADK,yCACpBS,IADoB,mBACpBA,IADoB,CAE5BH,mBAAmB,CAACG,IAAD,CAAnB,CAF4B,wDAAH,kBAArBC,CAAAA,qBAAqB,2CAA3B,CAKAhB,SAAS,CAAC,UAAM,CACd;AACA;AACAQ,QAAQ,CAACL,4BAA4B,CAACM,SAAS,CAACQ,MAAX,CAA7B,CAAR,CACD,CAJQ,CAIN,CAACR,SAAD,CAAYD,QAAZ,CAJM,CAAT,CAMAR,SAAS,CAAC,UAAM,CACd;AACAQ,QAAQ,CAACJ,yBAAyB,CAACO,gBAAgB,CAACM,MAAlB,CAA1B,CAAR,CACD,CAHQ,CAGN,CAACN,gBAAD,CAAmBH,QAAnB,CAHM,CAAT,CAKAR,SAAS,CAAC,UAAM,CACdgB,qBAAqB,GACrB,GAAIE,CAAAA,SAAJ,CACA,QAASC,CAAAA,kBAAT,EAA8B,CAC5BN,cAAc,GAEd;AACAK,SAAS,CAAGE,UAAU,CAACD,kBAAD,CAAqB,KAAO,EAA5B,CAAtB,CACD,CACDA,kBAAkB,GAElB,MAAO,WAAM,CACXE,YAAY,CAACH,SAAD,CAAZ,CACAR,YAAY,CAAC,EAAD,CAAZ,CACD,CAHD,CAID,CAfQ,CAeN,EAfM,CAAT,CAiBA,GAAMY,CAAAA,gBAAgB,2FAAG,kBAAOC,EAAP,6IACjBxB,CAAAA,KAAK,CAACyB,GAAN,CAAUlB,GAAG,CAAG,0BAAhB,CAA4C,CAChDiB,EAAE,CAAFA,EADgD,CAEhDE,OAAO,CAAE,IAFuC,CAA5C,CADiB,QAMvBZ,cAAc,GACdG,qBAAqB,GAPE,wDAAH,kBAAhBM,CAAAA,gBAAgB,6CAAtB,CAWA,mBACE,aAAK,SAAS,CAAC,mCAAf,wBACE,WACE,KAAK,CAAE,CACLI,SAAS,CAAE,QADN,CAELC,YAAY,CAAE,MAFT,CAGLC,KAAK,CAAE,SAHF,CADT,UAOGnB,SAAS,CAACQ,MAAV,CACG,yBADH,CAEG,4BATN,EADF,cAaE,KAAC,WAAD,EACE,gBAAgB,KADlB,CAEE,SAAS,CAAER,SAFb,CAGE,MAAM,CAAEa,gBAHV,CAIE,GAAG,CAAC,WAJN,EAbF,GADF,CAsBD,CA9ED,CAgFA,cAAef,CAAAA,gBAAf","sourcesContent":["import axios from \"axios\";\nimport { useEffect, useState /*, useRef*/ } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  changenouvelleCommandeLength,\n  changeCommandeCoursLength,\n} from \"../../../app/Redux-slices/adminSlice\";\nimport ProductList from \"../product/ProductList\";\nimport { URL } from \"../../../middlewares/request\";\n//import ReactStopwatch from 'react-stopwatch';\n\nconst NouvelleCommande = () => {\n  const dispatch = useDispatch();\n  const [commandes, setCommandes] = useState([]);\n  const [commandesEnCours, setCommandesEnCours] = useState([]);\n  // const [running, setRunning] = useState(false);\n  // const [currentTimeMin, setCurrentTimeMin] = useState(0);\n\n  const fetchCommandes = async () => {\n    const { data } = await axios.get(URL + \"paiement/nouvelle-commande\");\n    setCommandes(data);\n  };\n\n  const fetchCommandesEnCours = async () => {\n    const { data } = await axios.get(URL + \"paiement/commande-encours\");\n    setCommandesEnCours(data);\n  };\n\n  useEffect(() => {\n    // console.log(\"Commande: \",commandes)\n    // a chaque fois que commande change, on met a jour la longueur de nouvelle commande\n    dispatch(changenouvelleCommandeLength(commandes.length));\n  }, [commandes, dispatch]);\n\n  useEffect(() => {\n    // a chaque fois que commande change, on met a jour la longueur de nouvelle commande\n    dispatch(changeCommandeCoursLength(commandesEnCours.length));\n  }, [commandesEnCours, dispatch]);\n\n  useEffect(() => {\n    fetchCommandesEnCours();\n    let timeoutId;\n    function getLatestCommandes() {\n      fetchCommandes();\n\n      // wait for the response from fetchCommandes , before we recall it (delay of 1minute)\n      timeoutId = setTimeout(getLatestCommandes, 1000 * 60);\n    }\n    getLatestCommandes();\n\n    return () => {\n      clearTimeout(timeoutId);\n      setCommandes([]);\n    };\n  }, []);\n\n  const commande_est_vue = async (id) => {\n    await axios.put(URL + \"paiement/update-commande\", {\n      id,\n      est_vue: true,\n    });\n\n    fetchCommandes();\n    fetchCommandesEnCours();\n  };\n  \n\n  return (\n    <div className=\"nouvelleCommande admin__container\">\n      <h1\n        style={{\n          textAlign: \"center\",\n          marginBottom: \"2rem\",\n          color: \"#04295d\",\n        }}\n      >\n        {commandes.length\n          ? \"Vos Nouvelles Commandes\"\n          : \"Pas de Nouvelles commandes\"}\n      </h1>\n\n      <ProductList\n        nouvelleCommande\n        commandes={commandes}\n        action={commande_est_vue}\n        btn=\"confirmer\"\n      />\n    </div>\n  );\n};\n\nexport default NouvelleCommande;\n"]},"metadata":{},"sourceType":"module"}