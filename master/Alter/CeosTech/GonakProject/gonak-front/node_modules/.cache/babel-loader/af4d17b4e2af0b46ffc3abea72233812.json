{"ast":null,"code":"import _defineProperty from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from\"axios\";import Avatar from'@material-ui/core/Avatar';import Button from'@material-ui/core/Button';import CssBaseline from'@material-ui/core/CssBaseline';import TextField from'@material-ui/core/TextField';import Typography from'@material-ui/core/Typography';import Container from'@material-ui/core/Container';import{useSelector}from'react-redux';import{useHistory}from\"react-router-dom\";import{makeStyles}from'@material-ui/core/styles';import{URL}from\"../../../middlewares/request\";// import jwt_decode from \"jwt-decode\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{paper:{marginTop:theme.spacing(5),display:'flex',flexDirection:'column',alignItems:'center',backgroundColor:'white',padding:10,borderRadius:'3%',boxShadow:' 0px 0px 5px 1px',//opacity:'80%',\nborder:'solid #04295D'},avatar:{margin:theme.spacing(1),backgroundColor:\"#04295D\"},form:{width:'100%',// Fix IE 11 issue.\nmarginTop:theme.spacing(1)},submit:{margin:theme.spacing(3,0,2)//backgroundColor:theme.palette.secondary,\n},disable:{backgroundColor:\"#04295D\"},error:{color:'red',fontWeight:'bold',fontSize:13,textAlign:'center'},Container:{marginTop:100},input:{fontWeight:'bold'},main:{height:800},logo:{width:150,height:150,marginTop:\"10px\",marginBottom:\"10px\"},logoContainer:{width:\"100%\",backgroundColor:\"#04295D\",textAlign:\"center\"}};});var Login=function Login(){var classes=useStyles();var _useState=useState({username:\"\",password:\"\",errors:\" \"}),_useState2=_slicedToArray(_useState,2),loginState=_useState2[0],setloginState=_useState2[1];var security=useSelector(function(state){return state.security;});var errors=useSelector(function(state){return state.errors;});var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),shoudDisableSignIn=_useState4[0],setShoudDisableSignIn=_useState4[1];var history=useHistory();var updateDisponibiliteRestaurant=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(disponibilite){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.put(URL+\"restaurant/info_restaurant/1/\",{disponibilite_restaurant:disponibilite}).then(function(res){return history.push(\"/admin\");});case 2:case\"end\":return _context.stop();}}},_callee);}));return function updateDisponibiliteRestaurant(_x){return _ref.apply(this,arguments);};}();var authenticate=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(loginRequest){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios({url:\"\".concat(URL,\"accounts/token/\"),method:'post',//headers: {'Access-Control-Allow-Origin': '*'},\ndata:loginRequest}).then(function(res){// extract token from res.data\nvar access=res.data.access;// store the token in the localStorage\nlocalStorage.setItem(\"jwtToken\",access);// set our token in header ***\n// decode token on React\n// // const decoded = jwt_decode(token);\n// dispatch to our securityReducer\nsetShoudDisableSignIn(false);updateDisponibiliteRestaurant(true);}).catch(function(err){setloginState(_objectSpread(_objectSpread({},loginState),{},{errors:\"Email ou mot de passe incorrecte\"}));setShoudDisableSignIn(false);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function authenticate(_x2){return _ref2.apply(this,arguments);};}();var onChange=function onChange(e){setloginState(_objectSpread(_objectSpread({},loginState),{},_defineProperty({},e.target.name,e.target.value)));};var onSubmit=function onSubmit(e){setShoudDisableSignIn(true);e.preventDefault();var loginRequest={username:loginState.username,password:loginState.password};authenticate(loginRequest);};return/*#__PURE__*/_jsxs(\"div\",{className:classes.main,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.logoContainer,children:/*#__PURE__*/_jsx(\"img\",{src:\"logo_petit_m.png\",className:classes.logo})}),/*#__PURE__*/_jsxs(Container,{component:\"main\",maxWidth:\"xs\",children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsxs(\"div\",{className:classes.paper,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.avatar}),/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h5\",children:\"Connection\"}),/*#__PURE__*/_jsxs(\"form\",{className:classes.form,noValidate:true,onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(TextField,{variant:\"filled\",margin:\"normal\",required:true,fullWidth:true,id:\"email\",classname:classes.input,label:\"addresse mail\",name:\"username\",autoComplete:\"email\",autoFocus:true,onChange:onChange}),/*#__PURE__*/_jsx(TextField,{variant:\"filled\",margin:\"normal\",required:true,fullWidth:true,name:\"password\",label:\"mot de passe\",type:\"password\",id:\"password\",autoComplete:\"current-password\",onChange:onChange}),loginState.errors!==\"\"&&/*#__PURE__*/_jsxs(\"p\",{className:classes.error,children:[loginState.errors,\" \"]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"secondary\",className:!shoudDisableSignIn?classes.submit:classes.disable,disabled:shoudDisableSignIn,children:shoudDisableSignIn?/*#__PURE__*/_jsx(\"div\",{style:{color:\"brown\"},children:\"Connection au serveur ..... \"}):'Connection '})]})]})]})]});};export default Login;","map":{"version":3,"sources":["/home/christopher/Documents/Alter/GonakProject/gonak-front/src/components/admin/security/Login.js"],"names":["React","useState","useEffect","axios","Avatar","Button","CssBaseline","TextField","Typography","Container","useSelector","useHistory","makeStyles","URL","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","backgroundColor","padding","borderRadius","boxShadow","border","avatar","margin","form","width","submit","disable","error","color","fontWeight","fontSize","textAlign","input","main","height","logo","marginBottom","logoContainer","Login","classes","username","password","errors","loginState","setloginState","security","state","shoudDisableSignIn","setShoudDisableSignIn","history","updateDisponibiliteRestaurant","disponibilite","put","disponibilite_restaurant","then","res","push","authenticate","loginRequest","url","method","data","access","localStorage","setItem","catch","err","onChange","e","target","name","value","onSubmit","preventDefault"],"mappings":"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","sourcesContent":["import React ,{useState,useEffect} from 'react';\nimport axios from \"axios\";\nimport Avatar from '@material-ui/core/Avatar';\nimport Button from '@material-ui/core/Button';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport Container from '@material-ui/core/Container';\nimport {useSelector} from 'react-redux';\nimport { useHistory } from \"react-router-dom\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport { URL } from \"../../../middlewares/request\";\n\n// import jwt_decode from \"jwt-decode\";\n\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    marginTop: theme.spacing(5),\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    backgroundColor:'white',\n    padding:10,\n    borderRadius:'3%',\n    boxShadow:' 0px 0px 5px 1px',\n    //opacity:'80%',\n    border :'solid #04295D'\n\n\n  },\n  avatar: {\n    margin: theme.spacing(1),\n    backgroundColor: \"#04295D\",\n  },\n  form: {\n    width:'100%', // Fix IE 11 issue.\n    marginTop: theme.spacing(1),\n\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2),\n    //backgroundColor:theme.palette.secondary,\n  },\n  disable: {\n    backgroundColor:\"#04295D\",\n\n  },\n  error:{\n    color:'red',\n    fontWeight:'bold',\n    fontSize:13,\n    textAlign:'center'\n  }\n  ,\n  Container:{\n    marginTop:100,\n  },\n  input:{\n     fontWeight:'bold'\n  },\n  main:{\n    height : 800 ,   \n  },\n  logo:{\n    width:150,\n    height:150,\n    marginTop:\"10px\",\n    marginBottom:\"10px\"\n  },\n  logoContainer:{\n    width:\"100%\",\n    backgroundColor:\"#04295D\",\n    textAlign: \"center\"\n\n  }\n}));\nconst  Login =() =>{\n    const classes = useStyles();\n    const [loginState,setloginState]=useState({username: \"\",password: \"\",errors: \" \"});\n    const security=useSelector(state=>state.security);\n    const errors=useSelector(state=>state.errors);\n    const [shoudDisableSignIn,setShoudDisableSignIn]=useState(false);\n    const history =useHistory();\n\n    const updateDisponibiliteRestaurant = async (disponibilite) => {\n        await axios.put(URL + \"restaurant/info_restaurant/1/\", {\n          disponibilite_restaurant: disponibilite,\n        }).then(res=>history.push(\"/admin\")\n        );\n      };\n    const authenticate = async(loginRequest)=>{\n        await axios({\n            url:`${URL}accounts/token/`,\n            method:'post',\n            //headers: {'Access-Control-Allow-Origin': '*'},\n            data: loginRequest\n            }).\n            then(res=>{\n                // extract token from res.data\n                const { access } = res.data;\n                // store the token in the localStorage\n                localStorage.setItem(\"jwtToken\", access);\n                // set our token in header ***\n                // decode token on React\n                // // const decoded = jwt_decode(token);\n                // dispatch to our securityReducer\n                setShoudDisableSignIn(false);\n                updateDisponibiliteRestaurant(true);\n            }).catch(err=>{\n                setloginState({...loginState,errors:\"Email ou mot de passe incorrecte\"})\n                setShoudDisableSignIn(false);\n            })\n    }\n\n    const onChange =(e)=>{\n      setloginState({ ...loginState,[e.target.name]: e.target.value });\n    }\n    const onSubmit =(e)=> {\n      setShoudDisableSignIn(true);\n      e.preventDefault();\n      const loginRequest = {\n        username: loginState.username,\n        password: loginState.password\n      };\n      authenticate(loginRequest);\n    }\n  return (\n    <div className={classes.main}>\n    <div className={classes.logoContainer}><img src =\"logo_petit_m.png\" className={classes.logo} /></div>\n    <Container component=\"main\" maxWidth=\"xs\"  >\n      <CssBaseline />\n      <div className={classes.paper}  >\n        <Avatar className={classes.avatar}/>\n        <Typography component=\"h1\" variant=\"h5\">\n            Connection\n        </Typography>\n        <form className={classes.form} noValidate onSubmit={onSubmit}>\n         <TextField\n            variant=\"filled\"\n            margin=\"normal\"\n            required\n            fullWidth\n            id=\"email\"\n            classname={classes.input}\n            label=\"addresse mail\"\n            name=\"username\"\n            autoComplete=\"email\"\n            autoFocus\n            onChange={onChange}\n          />\n          <TextField\n            variant=\"filled\"\n            margin=\"normal\"\n            required\n            fullWidth\n            name=\"password\"\n            label=\"mot de passe\"\n            type=\"password\"\n            id=\"password\"\n            autoComplete=\"current-password\"\n            onChange={onChange}\n          />\n          {loginState.errors!==\"\" && <p className={classes.error}>{loginState.errors} </p>}\n          <Button\n            type=\"submit\"\n            fullWidth\n            variant=\"contained\"\n            color=\"secondary\"\n            className={!shoudDisableSignIn?classes.submit:classes.disable}\n            disabled={shoudDisableSignIn}\n          >\n             {shoudDisableSignIn?<div style={{color:\"brown\"}}>Connection au serveur ..... </div>:'Connection '}\n          </Button>\n        </form>\n      </div>\n    </Container>\n    </div>\n  );\n}\nexport default Login;"]},"metadata":{},"sourceType":"module"}