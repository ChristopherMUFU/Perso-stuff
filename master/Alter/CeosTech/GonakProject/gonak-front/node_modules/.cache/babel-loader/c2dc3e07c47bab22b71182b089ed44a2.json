{"ast":null,"code":"import _objectSpread from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useHistory}from\"react-router-dom\";import{useState,useEffect}from\"react\";import useForm from\"../../../hooks/useForm\";import{sendrequest}from\"../../../middlewares/request\";import ModalBootsrap from\"../modal/Modal\";import{TextField}from'@material-ui/core';import axios from\"axios\";import{URL}from\"../../../middlewares/request\";import'./societe.css';/*const initial = {\n      nom: \"\",\n      prenom: \"\",\n      adresse_mail: \"\",\n      num_tel: \"\",\n      code_postal: \"\",\n      ville:\"\",\n      adresse:\"\",\n      poste_occupe:\"\",\n\n};*/import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UpdateFormSociete=function UpdateFormSociete(_ref){var restaurantOwner=_ref.restaurantOwner;var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),success=_useState4[0],setSuccess=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),dirigeant=_useState6[0],setDirigeant=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),initState=_useState8[0],setInitState=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),infoRestaurant=_useState10[0],setInfoRestaurant=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),infoEntreprise=_useState12[0],setInfoEntreprise=_useState12[1];var handleClose=function handleClose(){return setShow(false);};var handleShow=function handleShow(){return setShow(true);};var token=window.$token_access;var email=window.$email_dirigeant;var password_dir=window.$password_dirigeant;var updateData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.put(URL+\"accounts/restaurantowner/\"+restaurantOwner.id+\"/\",{nom:restaurantOwner.nom,prénom:restaurantOwner.prénom,email:restaurantOwner.email,phone_number:restaurantOwner.phone_number,company_position:restaurantOwner.company_position,restaurant:{name:state.etablissement,address:state.adresse_etablissement,postal_code:state.code_postal_etablissement,city:state.ville_etablissement,phone_number:restaurantOwner.restaurant.phone_number},company:{name:state.denomination,address:state.adresse_siege,postal_code:state.code_postal_siege,city:state.ville_siege,capital:restaurantOwner.company.capital,SIRET_number:state.SIRET_number,retirement_fund_name:restaurantOwner.company.retirement_fund_name,retirement_fund_address:restaurantOwner.company.retirement_fund_address,retirement_fund_city:restaurantOwner.company.retirement_fund_city,retirement_fund_postal_code:restaurantOwner.company.retirement_fund_postal_code},user:{//username: state.adresse_mail,\nemail:state.adresse_mail,password:password_dir}},{headers:{'Authorization':\"Bearer \".concat(token)}}).then(function(result){console.log(result.data);});case 2:res=_context.sent;case 3:case\"end\":return _context.stop();}}},_callee);}));return function updateData(){return _ref2.apply(this,arguments);};}();var estValide=function estValide(){var fieldValues=arguments.length>0&&arguments[0]!==undefined?arguments[0]:state;var validator={};if(\"denomination\"in fieldValues)validator.denomination=state.denomination?null:\"Le champ nom est obligatore\";if(\"adresse_siege\"in fieldValues)validator.adresse_siege=state.adresse_siege?null:\"Le champ prénom est obligatore\";if(\"code_postal_siege\"in fieldValues)validator.code_postal_siege=/^(([0-8][0-9])|(9[0-5]))[0-9]{3}$/.test(code_postal_siege)?null:\"Le code postal n'est pas valide\";if(\"ville_siege\"in fieldValues)validator.ville_siege=state.ville_siege?null:\"Le champ ville est obligatore\";if(\"SIRET_number\"in fieldValues)validator.SIRET_number=/^[0-9]{14}$/.test(SIRET_number)?null:\"Le numéro de SIRET n'est pas valide\";if(\"etablissement\"in fieldValues)validator.etablissement=state.etablissement?null:\"Le champ etablissement est obligatore\";if(\"adresse_etablissement\"in fieldValues)validator.adresse_etablissement=state.adresse_etablissement?null:\"Le champ adresse etablissement est obligatore\";if(\"code_postal_etablissement\"in fieldValues)validator.code_postal_etablissement=/^(([0-8][0-9])|(9[0-5]))[0-9]{3}$/.test(code_postal_etablissement)?null:\"Le code postal n'est pas valide\";if(\"ville_etablissement\"in fieldValues)validator.ville_etablissement=state.ville_etablissement?null:\"Le champ ville etablissement est obligatore\";setErrors(_objectSpread({},validator));// retourne boolean si et seulement si on passe un parametre pour la fonction\nif(fieldValues===state){return Object.values(validator).every(function(el){return!el;});}};var _useForm=useForm(initState,estValide),state=_useForm.state,handleInputChange=_useForm.handleInputChange,errors=_useForm.errors,setErrors=_useForm.setErrors,reinitialiserState=_useForm.reinitialiserState;var denomination=state.denomination,adresse_siege=state.adresse_siege,ville_siege=state.ville_siege,adresse_etablissement=state.adresse_etablissement,code_postal_siege=state.code_postal_siege,SIRET_number=state.SIRET_number,etablissement=state.etablissement,code_postal_etablissement=state.code_postal_etablissement;//state.prenom = restaurantOwner.prénom\n//Fonction permettant d'afficher les données récupérés\n//contenant => input modifiable\n//contenue => donnée à afficher\nvar preAffichage=function preAffichage(contenant){if(contenant===undefined){state.denomination=restaurantOwner.company.name;state.adresse_siege=restaurantOwner.company.address;state.ville_siege=restaurantOwner.company.city;state.SIRET_number=restaurantOwner.company.SIRET_number;state.code_postal_siege=restaurantOwner.company.postal_code;state.adresse_etablissement=restaurantOwner.restaurant.address;state.ville_etablissement=restaurantOwner.restaurant.city;state.etablissement=restaurantOwner.restaurant.name;state.code_postal_etablissement=restaurantOwner.restaurant.postal_code;console.log(contenant);return state.denomination+\"\";}return contenant+\"\";};var handleSubmit=function handleSubmit(e){e.preventDefault();if(restaurantOwner===[]){//reinitialiserState();\nif(estValide()){sendrequest(\"put\",\"main/societe/\",null,null,state).then(function(response){if(response!==false&&estValide()){setSuccess(true);handleShow();}else{setSuccess(false);handleShow();}});}}else{updateData();RedirectionInfo();}};var RedirectionInfo=function RedirectionInfo(){var url=\"/admin/mon-compte/infos-personnelles\";history.push(url);};return/*#__PURE__*/_jsx(_Fragment,{children:restaurantOwner!==undefined&&restaurantOwner.restaurant!==undefined?/*#__PURE__*/_jsxs(\"form\",{className:\"societe_container\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"societe_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"D\\xE9nomination sociale\",id:\"outlined-basic\",variant:\"outlined\",className:\"societe_input\",name:\"denomination\",value:preAffichage(state.denomination),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.denomination})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"societe_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Adresse du si\\xE8ge social\",id:\"outlined-basic\",variant:\"outlined\",className:\"societe_input\",name:\"adresse_siege\",value:preAffichage(state.adresse_siege),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.adresse_siege})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"societe_adresse\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"societe_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Code postal\",id:\"outlined-basic\",variant:\"outlined\",className:\"code_input\",name:\"code_postal_siege\",value:preAffichage(state.code_postal_siege),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.code_postal_siege})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"societe_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Ville\",id:\"outlined-basic\",variant:\"outlined\",className:\"ville_input\",name:\"ville_siege\",value:preAffichage(state.ville_siege),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.ville_siege})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"societe_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"SIRET\",id:\"outlined-basic\",variant:\"outlined\",type:\"number\",className:\"societe_input\",name:\"SIRET\",value:preAffichage(state.SIRET_number),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.SIRET_number})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"societe_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Etablissement (lieu de travail des salari\\xE9s)\",id:\"outlined-basic\",variant:\"outlined\",className:\"societe_input\",name:\"etablissement\",value:preAffichage(state.etablissement),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.etablissement})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"societe_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Adresse de l\\xE9tablissement\",id:\"outlined-basic\",variant:\"outlined\",className:\"societe_input\",name:\"adresse_etablissement\",value:preAffichage(state.adresse_etablissement),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.adresse_etablissement})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"societe_adresse\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"societe_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Code postal\",id:\"outlined-basic\",variant:\"outlined\",className:\"code_input\",name:\"code_postal_etablissement\",value:preAffichage(state.code_postal_etablissement),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.code_postal_etablissement})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"societe_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Ville\",id:\"outlined-basic\",variant:\"outlined\",className:\"ville_input\",name:\"ville_etablissement\",value:preAffichage(state.ville_etablissement),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.code_postal_etablissement})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"societe_button\",children:/*#__PURE__*/_jsx(\"button\",{className:\"registre_button\",type:\"submit\",children:\"Enregistrer\"})}),/*#__PURE__*/_jsx(ModalBootsrap,{handleClose:handleClose,show:show,title:/*#__PURE__*/_jsxs(_Fragment,{children:[success?\"Envoyé\":\"Oups\",/*#__PURE__*/_jsx(\"i\",{className:\"\".concat(success?\" fas fa-thumbs-up\":\" fas fa-thumbs-down\"),style:{color:\"#4caf50\",marginLeft:\"1rem\"}})]}),children:success?\"Enregistrement avec succès.\":\"Une erreur s'est produite, veuillez réessayer.\"})]}):null});};export default UpdateFormSociete;","map":{"version":3,"sources":["/home/christopher/Documents/Alter/GonakProject/gonak-front/src/components/admin/societe/UpdateFormSociete.js"],"names":["React","useHistory","useState","useEffect","useForm","sendrequest","ModalBootsrap","TextField","axios","URL","UpdateFormSociete","restaurantOwner","history","show","setShow","success","setSuccess","dirigeant","setDirigeant","initState","setInitState","infoRestaurant","setInfoRestaurant","infoEntreprise","setInfoEntreprise","handleClose","handleShow","token","window","$token_access","email","$email_dirigeant","password_dir","$password_dirigeant","updateData","put","id","nom","prénom","phone_number","company_position","restaurant","name","state","etablissement","address","adresse_etablissement","postal_code","code_postal_etablissement","city","ville_etablissement","company","denomination","adresse_siege","code_postal_siege","ville_siege","capital","SIRET_number","retirement_fund_name","retirement_fund_address","retirement_fund_city","retirement_fund_postal_code","user","adresse_mail","password","headers","then","result","console","log","data","res","estValide","fieldValues","validator","test","setErrors","Object","values","every","el","handleInputChange","errors","reinitialiserState","preAffichage","contenant","undefined","handleSubmit","e","preventDefault","response","RedirectionInfo","url","push","color","marginLeft"],"mappings":"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","sourcesContent":["import React, {useHistory} from \"react-router-dom\";\nimport  { useState, useEffect } from \"react\";\nimport useForm from \"../../../hooks/useForm\";\n import {sendrequest} from \"../../../middlewares/request\";\nimport ModalBootsrap from \"../modal/Modal\";\nimport {TextField} from '@material-ui/core';\nimport axios from \"axios\";\nimport {URL} from \"../../../middlewares/request\";\n\nimport './societe.css'\n\n/*const initial = {\n      nom: \"\",\n      prenom: \"\",\n      adresse_mail: \"\",\n      num_tel: \"\",\n      code_postal: \"\",\n      ville:\"\",\n      adresse:\"\",\n      poste_occupe:\"\",\n\n};*/\n\nconst UpdateFormSociete = ({restaurantOwner}) => {\n\n    const history = useHistory();\n\n    const [show, setShow] = useState(false);\n    const [success, setSuccess] = useState(false);\n    const [dirigeant, setDirigeant] = useState([]);\n    const [initState, setInitState] = useState([]);\n    const [infoRestaurant, setInfoRestaurant] = useState([]);\n    const [infoEntreprise, setInfoEntreprise] = useState([]);\n\n    const handleClose = () => setShow(false);\n    const handleShow = () => setShow(true);\n\n\n    const token = window.$token_access;\n    const email = window.$email_dirigeant;\n    const password_dir = window.$password_dirigeant;\n\n\n    const updateData = async () => {\n       const res = await axios.put(\n                URL + \"accounts/restaurantowner/\" + restaurantOwner.id + \"/\"\n            ,{\n                nom: restaurantOwner.nom,\n                prénom: restaurantOwner.prénom,\n                email: restaurantOwner.email,\n                phone_number: restaurantOwner.phone_number,\n                company_position: restaurantOwner.company_position,\n                restaurant: {\n                    name: state.etablissement,\n                    address: state.adresse_etablissement,\n                    postal_code: state.code_postal_etablissement,\n                    city: state.ville_etablissement,\n                    phone_number: restaurantOwner.restaurant.phone_number\n                },\n                company: {\n                    name: state.denomination,\n                    address: state.adresse_siege,\n                    postal_code: state.code_postal_siege,\n                    city: state.ville_siege,\n                    capital: restaurantOwner.company.capital,\n                    SIRET_number: state.SIRET_number,\n\n                    retirement_fund_name: restaurantOwner.company.retirement_fund_name,\n                    retirement_fund_address: restaurantOwner.company.retirement_fund_address,\n                    retirement_fund_city: restaurantOwner.company.retirement_fund_city,\n                    retirement_fund_postal_code: restaurantOwner.company.retirement_fund_postal_code\n                },\n                user: {\n                    //username: state.adresse_mail,\n                    email: state.adresse_mail,\n                    password: password_dir\n                }\n            },\n            {\n                headers: {\n                    'Authorization': `Bearer ${token}`\n                }\n            }\n      ).then((result) => {console.log(result.data)});\n\n      //console.log(res.data);\n\n    }\n\n\n\n      const estValide = (fieldValues = state) => {\n      const validator = {};\n\n       if (\"denomination\" in fieldValues)\n              validator.denomination = state.denomination ? null : \"Le champ nom est obligatore\";\n\n          if (\"adresse_siege\" in fieldValues)\n              validator.adresse_siege = state.adresse_siege ? null : \"Le champ prénom est obligatore\";\n\n          if (\"code_postal_siege\" in fieldValues)\n              validator.code_postal_siege = /^(([0-8][0-9])|(9[0-5]))[0-9]{3}$/.test(\n                  code_postal_siege\n              )\n                  ? null\n                  : \"Le code postal n'est pas valide\";\n\n\n          if (\"ville_siege\" in fieldValues)\n              validator.ville_siege = state.ville_siege ? null : \"Le champ ville est obligatore\";\n\n           if (\"SIRET_number\" in fieldValues)\n        validator.SIRET_number = /^[0-9]{14}$/.test(\n            SIRET_number\n        )\n            ? null\n            : \"Le numéro de SIRET n'est pas valide\";\n\n          if (\"etablissement\" in fieldValues)\n              validator.etablissement = state.etablissement ? null : \"Le champ etablissement est obligatore\";\n\n          if (\"adresse_etablissement\" in fieldValues)\n              validator.adresse_etablissement = state.adresse_etablissement ? null : \"Le champ adresse etablissement est obligatore\";\n\n          if (\"code_postal_etablissement\" in fieldValues)\n              validator.code_postal_etablissement = /^(([0-8][0-9])|(9[0-5]))[0-9]{3}$/.test(\n                  code_postal_etablissement\n              )\n                  ? null\n                  : \"Le code postal n'est pas valide\";\n\n          if (\"ville_etablissement\" in fieldValues)\n              validator.ville_etablissement = state.ville_etablissement ? null : \"Le champ ville etablissement est obligatore\";\n\n\n\n      setErrors({ ...validator });\n\n      // retourne boolean si et seulement si on passe un parametre pour la fonction\n      if (fieldValues === state) {\n        return Object.values(validator).every((el) => !el);\n      }\n    };\n\n\n     const {\n      state,\n      handleInputChange,\n      errors,\n      setErrors,\n      reinitialiserState,\n    } = useForm(initState, estValide);\n\n    const { denomination, adresse_siege, ville_siege,adresse_etablissement,code_postal_siege,SIRET_number, etablissement, code_postal_etablissement} = state\n\n    //state.prenom = restaurantOwner.prénom\n    //Fonction permettant d'afficher les données récupérés\n    //contenant => input modifiable\n    //contenue => donnée à afficher\n    const preAffichage = (contenant) => {\n        if(contenant === undefined){\n            state.denomination = restaurantOwner.company.name\n            state.adresse_siege = restaurantOwner.company.address\n            state.ville_siege = restaurantOwner.company.city\n            state.SIRET_number = restaurantOwner.company.SIRET_number\n            state.code_postal_siege = restaurantOwner.company.postal_code\n\n            state.adresse_etablissement = restaurantOwner.restaurant.address\n            state.ville_etablissement = restaurantOwner.restaurant.city\n            state.etablissement =  restaurantOwner.restaurant.name\n            state.code_postal_etablissement=restaurantOwner.restaurant.postal_code\n\n\n            console.log(contenant)\n            return state.denomination + \"\"\n        }\n        return contenant + \"\"\n\n    }\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n\n        if(restaurantOwner === []){\n            //reinitialiserState();\n            if (estValide()) {\n                sendrequest(\"put\", \"main/societe/\", null, null, state)\n                .then((response) => {\n                    if (response !== false && estValide()) {\n                        setSuccess(true);\n                        handleShow();\n                    } else {\n                        setSuccess(false);\n                        handleShow();\n                    }\n                })\n            }\n        }\n        else{\n            updateData();\n            RedirectionInfo();\n        }\n\n    };\n\n\n        const RedirectionInfo = () => {\n            let url = \"/admin/mon-compte/infos-personnelles\";\n            history.push(url);\n        }\n        return (\n        <>\n                {restaurantOwner !== undefined && restaurantOwner.restaurant !== undefined ?\n\n                    <form className=\"societe_container\" onSubmit={handleSubmit}>\n\n                        <div className='societe_label'>\n                        <TextField\n                            fullWidth\n                            label =\"Dénomination sociale\"\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            className='societe_input'\n                            name='denomination'\n                            value={preAffichage(state.denomination)}\n                            onChange={handleInputChange}\n                            required/>\n                                <div className=\"errors\">{errors.denomination}</div>\n                        </div>\n\n\n                        <div className='societe_label'>\n                        <TextField\n                            fullWidth\n                            label =\"Adresse du siège social\"\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            className='societe_input'\n                            name='adresse_siege'\n                            value={preAffichage(state.adresse_siege)}\n                            onChange={handleInputChange}\n                            required/>\n                            <div className=\"errors\">{errors.adresse_siege}</div>\n                        </div>\n\n\n                    <div className='societe_adresse'>\n                        <div className='societe_label'>\n                        <TextField\n                            fullWidth\n                            label =\"Code postal\"\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            className='code_input'\n                            name='code_postal_siege'\n                            value={preAffichage(state.code_postal_siege)}\n                            onChange={handleInputChange}\n                            required/>\n                            <div className=\"errors\">{errors.code_postal_siege}</div>\n                        </div>\n\n                        <div className='societe_label'>\n                        <TextField\n                            fullWidth\n                            label =\"Ville\"\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            className='ville_input'\n                            name='ville_siege'\n                            value={preAffichage(state.ville_siege)}\n                            onChange={handleInputChange}\n                            required/>\n                            <div className=\"errors\">{errors.ville_siege}</div>\n                        </div>\n                    </div>\n\n                        <div className='societe_label'>\n                        <TextField\n                            fullWidth\n                            label =\"SIRET\"\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            type='number'\n                            className='societe_input'\n                            name='SIRET'\n                            value={preAffichage(state.SIRET_number)}\n                            onChange={handleInputChange}\n                            required/>\n                            <div className=\"errors\">{errors.SIRET_number}</div>\n                        </div>\n\n\n\n                        <div className='societe_label'>\n                        <TextField\n                            fullWidth\n                            label =\"Etablissement (lieu de travail des salariés)\"\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            className='societe_input'\n                            name='etablissement'\n                            value={preAffichage(state.etablissement)}\n                            onChange={handleInputChange}\n                            required/>\n                            <div className=\"errors\">{errors.etablissement}</div>\n                        </div>\n\n\n                        <div className='societe_label'>\n                        <TextField\n                            fullWidth\n                            label =\"Adresse de létablissement\"\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            className='societe_input'\n                            name='adresse_etablissement'\n                            value={preAffichage(state.adresse_etablissement)}\n                            onChange={handleInputChange}\n                            required/>\n                            <div className=\"errors\">{errors.adresse_etablissement}</div>\n                        </div>\n\n                    <div className='societe_adresse'>\n                        <div className='societe_label'>\n                        <TextField\n                            fullWidth\n                            label =\"Code postal\"\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            className='code_input'\n                            name='code_postal_etablissement'\n                            value={preAffichage(state.code_postal_etablissement)}\n                            onChange={handleInputChange}\n                            required/>\n                            <div className=\"errors\">{errors.code_postal_etablissement}</div>\n                        </div>\n\n                        <div className='societe_label'>\n                        <TextField\n                            fullWidth\n                            label =\"Ville\"\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            className='ville_input'\n                            name='ville_etablissement'\n                            value={preAffichage(state.ville_etablissement)}\n                            onChange={handleInputChange}\n                            required/>\n                            <div className=\"errors\">{errors.code_postal_etablissement}</div>\n                        </div>\n                    </div>\n\n                        <div className='societe_button'>\n                            <button className=\"registre_button\" type=\"submit\">Enregistrer</button>\n\n                        </div>\n                        <ModalBootsrap\n                            handleClose={handleClose}\n                            show={show}\n                            title={\n                                <>\n                                    {success ? \"Envoyé\" : \"Oups\"}\n                                    <i\n                                        className={\n                                            `${success ? \" fas fa-thumbs-up\" : \" fas fa-thumbs-down\"}`}\n                                        style={{color: \"#4caf50\", marginLeft: \"1rem\"}}></i>\n                                </>\n                            }>\n                            {success ? \"Enregistrement avec succès.\" : \"Une erreur s'est produite, veuillez réessayer.\"}\n                        </ModalBootsrap>\n\n\n\n                    </form>\n                    :null}\n            </>\n\n        );\n\n}\nexport default UpdateFormSociete;\n"]},"metadata":{},"sourceType":"module"}