{"ast":null,"code":"import _objectSpread from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/christopher/Documents/Alter/GonakProject/gonak-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useHistory}from\"react-router-dom\";import{useState,useEffect}from\"react\";import useForm from\"../../../hooks/useForm\";import{sendrequest}from\"../../../middlewares/request\";import ModalBootsrap from\"../modal/Modal\";import{TextField}from'@material-ui/core';import axios from\"axios\";import{URL}from\"../../../middlewares/request\";import'./dirigeant.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UpdateFormDirigeant=function UpdateFormDirigeant(_ref){var restaurantOwner=_ref.restaurantOwner;var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),success=_useState4[0],setSuccess=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),dirigeant=_useState6[0],setDirigeant=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),initState=_useState8[0],setInitState=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),infoRestaurant=_useState10[0],setInfoRestaurant=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),infoEntreprise=_useState12[0],setInfoEntreprise=_useState12[1];var handleClose=function handleClose(){return setShow(false);};var handleShow=function handleShow(){return setShow(true);};var token=window.$token_access;var email=window.$email_dirigeant;var password_dir=window.$password_dirigeant;var updateData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.put(URL+\"accounts/restaurantowner/\"+restaurantOwner.id+\"/\",{nom:state.nom,prénom:state.prenom,email:state.adresse_mail,phone_number:state.num_tel,company_position:state.poste_occupe,restaurant:{name:restaurantOwner.restaurant.name,address:state.adresse,postal_code:state.code_postal,city:state.ville,phone_number:restaurantOwner.restaurant.phone_number},company:{name:restaurantOwner.company.name,address:restaurantOwner.company.address,postal_code:restaurantOwner.company.postal_code,city:restaurantOwner.company.city,capital:restaurantOwner.company.capital,SIRET_number:restaurantOwner.company.SIRET_number,retirement_fund_name:restaurantOwner.company.retirement_fund_name,retirement_fund_address:restaurantOwner.company.retirement_fund_address,retirement_fund_city:restaurantOwner.company.retirement_fund_city,retirement_fund_postal_code:restaurantOwner.company.retirement_fund_postal_code},user:{//username: state.adresse_mail,\nemail:state.adresse_mail,password:password_dir}},{headers:{'Authorization':\"Bearer \".concat(token)}}).then(function(result){console.log(result);});case 2:res=_context.sent;case 3:case\"end\":return _context.stop();}}},_callee);}));return function updateData(){return _ref2.apply(this,arguments);};}();var estValide=function estValide(){var fieldValues=arguments.length>0&&arguments[0]!==undefined?arguments[0]:state;var validator={};if(\"nom\"in fieldValues)validator.nom=state.nom?null:\"Le champ nom est obligatore\";if(\"prenom\"in fieldValues)validator.prenom=state.prenom?null:\"Le champ prénom est obligatore\";if(\"adresse_mail\"in fieldValues)validator.adresse_mail=/([a-zA-Z0-9-_.+]{4,})@.+\\..+/.test(adresse_mail)?null:\"Le mail n'est pas valide\";if(\"adresse\"in fieldValues)validator.adresse=state.adresse?null:\"Le champ adresse est obligatore\";if(\"ville\"in fieldValues)validator.ville=state.ville?null:\"Le champ ville est obligatore\";if(\"poste_occupe\"in fieldValues)validator.poste_occupe=state.poste_occupe?null:\"Le champ poste occupée est obligatore\";if(\"code_postal\"in fieldValues)validator.code_postal=/^(([0-8][0-9])|(9[0-5]))[0-9]{3}$/.test(code_postal)?null:\"Le code postal n'est pas valide\";if(\"num_tel\"in fieldValues)validator.num_tel=/^(0|\\+33)[1-9]([-. ]?[0-9]{2}){4}$/.test(num_tel)?null:\"Le numéro de téléphone n'est pas valide\";setErrors(_objectSpread({},validator));// retourne boolean si et seulement si on passe un parametre pour la fonction\nif(fieldValues===state){return Object.values(validator).every(function(el){return!el;});}};var _useForm=useForm(initState,estValide),state=_useForm.state,handleInputChange=_useForm.handleInputChange,errors=_useForm.errors,setErrors=_useForm.setErrors,reinitialiserState=_useForm.reinitialiserState;var nom=state.nom,prenom=state.prenom,adresse_mail=state.adresse_mail,num_tel=state.num_tel,code_postal=state.code_postal,ville=state.ville,adresse=state.adresse,poste_occupe=state.poste_occupe;//state.prenom = restaurantOwner.prénom\n//Fonction permettant d'afficher les données récupérés\n//contenant => input modifiable\n//contenue => donnée à afficher\nvar preAffichage=function preAffichage(contenant){if(contenant===undefined){state.nom=restaurantOwner.nom;state.prenom=restaurantOwner.prénom;state.adresse_mail=restaurantOwner.email;state.num_tel=restaurantOwner.phone_number;state.adresse=restaurantOwner.restaurant.address;state.code_postal=restaurantOwner.restaurant.postal_code;state.ville=restaurantOwner.restaurant.city;state.poste_occupe=restaurantOwner.company_position;console.log(contenant);return state.nom+\"\";}return contenant+\"\";};var handleSubmit=function handleSubmit(e){e.preventDefault();// Cas où le dirigeant entre ces informations pour la 1ere fois\nif(restaurantOwner===[]){//reinitialiserState();\nif(estValide()){sendrequest(\"post\",\"main/dirigeant/\",null,null,state).then(function(response){if(response!==false&&estValide()){setSuccess(true);handleShow();}else{setSuccess(false);handleShow();}});}}else{updateData();setSuccess(true);handleShow();//RedirectionInfo();\n}};var RedirectionInfo=function RedirectionInfo(){var url=\"/admin/mon-compte/infos-personnelles\";history.push(url);};return/*#__PURE__*/_jsx(_Fragment,{children:restaurantOwner!==undefined&&restaurantOwner.restaurant!==undefined?/*#__PURE__*/_jsxs(\"form\",{className:\"dirigeant_container\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dirigeant_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,className:\"dirigeant_input\",id:\"outlined-basic\",variant:\"outlined\",label:\"Nom du dirigeant\",name:\"nom\",value:preAffichage(state.nom),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.nom})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dirigeant_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,className:\"dirigeant_input\",id:\"outlined-basic\",variant:\"outlined\",label:\"Pr\\xE9nom du dirigeant\",name:\"prenom\",value:preAffichage(state.prenom),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.prenom})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dirigeant_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,className:\"dirigeant_input\",id:\"outlined-basic\",variant:\"outlined\",label:\"Adresse\",name:\"adresse\",value:preAffichage(state.adresse),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.adresse})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dirigeant_adresse\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dirigeant_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,className:\"dirigeant_input\",id:\"outlined-basic\",variant:\"outlined\",label:\"Code postal\",name:\"code_postal\",value:preAffichage(state.code_postal),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.code_postal})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dirigeant_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,className:\"dirigeant_input\",id:\"outlined-basic\",variant:\"outlined\",label:\"Ville\",name:\"ville\",value:preAffichage(state.ville),onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.ville})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dirigeant_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,className:\"dirigeant_input\",id:\"outlined-basic\",variant:\"outlined\",label:\"Adresse mail\",name:\"adresse_mail\",value:state.adresse_mail,onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.adresse_mail})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dirigeant_adresse\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dirigeant_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,className:\"dirigeant_input\",id:\"outlined-basic\",variant:\"outlined\",label:\"Poste occup\\xE9\",value:preAffichage(state.poste_occupe),name:\"poste_occupe\",onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.poste_occupe})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dirigeant_label\",children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,className:\"dirigeant_input\",id:\"outlined-basic\",variant:\"outlined\",label:\"Num\\xE9ro de t\\xE9l\\xE9phone\",name:\"num_tel\",value:state.num_tel,onChange:handleInputChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errors.num_tel})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"dirigeant_button\",children:/*#__PURE__*/_jsx(\"button\",{className:\"registre_button\",type:\"submit\",children:\"Enregistrer\"})}),/*#__PURE__*/_jsx(ModalBootsrap,{handleClose:handleClose,show:show,title:/*#__PURE__*/_jsxs(_Fragment,{children:[success?\"Envoyé\":\"Oups\",/*#__PURE__*/_jsx(\"i\",{className:\"\".concat(success?\" fas fa-thumbs-up\":\" fas fa-thumbs-down\"),style:{color:\"#4caf50\",marginLeft:\"1rem\"}})]}),children:success?\"Enregistrement avec succès.\":\"Une erreur s'est produite, veuillez réessayer.\"})]}):null});};export default UpdateFormDirigeant;","map":{"version":3,"sources":["/home/christopher/Documents/Alter/GonakProject/gonak-front/src/components/admin/dirigeant/UpdateFormDirigeant.js"],"names":["React","useHistory","useState","useEffect","useForm","sendrequest","ModalBootsrap","TextField","axios","URL","UpdateFormDirigeant","restaurantOwner","history","show","setShow","success","setSuccess","dirigeant","setDirigeant","initState","setInitState","infoRestaurant","setInfoRestaurant","infoEntreprise","setInfoEntreprise","handleClose","handleShow","token","window","$token_access","email","$email_dirigeant","password_dir","$password_dirigeant","updateData","put","id","nom","state","prénom","prenom","adresse_mail","phone_number","num_tel","company_position","poste_occupe","restaurant","name","address","adresse","postal_code","code_postal","city","ville","company","capital","SIRET_number","retirement_fund_name","retirement_fund_address","retirement_fund_city","retirement_fund_postal_code","user","password","headers","then","result","console","log","res","estValide","fieldValues","validator","test","setErrors","Object","values","every","el","handleInputChange","errors","reinitialiserState","preAffichage","contenant","undefined","handleSubmit","e","preventDefault","response","RedirectionInfo","url","push","color","marginLeft"],"mappings":"gsBAAA,MAAOA,CAAAA,KAAP,EAAeC,UAAf,KAAgC,kBAAhC,CACA,OAAUC,QAAV,CAAoBC,SAApB,KAAqC,OAArC,CACA,MAAOC,CAAAA,OAAP,KAAoB,wBAApB,CACC,OAAQC,WAAR,KAA0B,8BAA1B,CACD,MAAOC,CAAAA,aAAP,KAA0B,gBAA1B,CACA,OAAQC,SAAR,KAAwB,mBAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAAQC,GAAR,KAAkB,8BAAlB,CAEA,MAAO,iBAAP,C,6IAGA,GAAMC,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,MAAuB,IAArBC,CAAAA,eAAqB,MAArBA,eAAqB,CAE/C,GAAMC,CAAAA,OAAO,CAAGX,UAAU,EAA1B,CAEA,cAAwBC,QAAQ,CAAC,KAAD,CAAhC,wCAAOW,IAAP,eAAaC,OAAb,eACA,eAA8BZ,QAAQ,CAAC,KAAD,CAAtC,yCAAOa,OAAP,eAAgBC,UAAhB,eACA,eAAkCd,QAAQ,CAAC,EAAD,CAA1C,yCAAOe,SAAP,eAAkBC,YAAlB,eACA,eAAkChB,QAAQ,CAAC,EAAD,CAA1C,yCAAOiB,SAAP,eAAkBC,YAAlB,eACA,eAA4ClB,QAAQ,CAAC,EAAD,CAApD,0CAAOmB,cAAP,gBAAuBC,iBAAvB,gBACA,gBAA4CpB,QAAQ,CAAC,EAAD,CAApD,2CAAOqB,cAAP,gBAAuBC,iBAAvB,gBAEA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,SAAMX,CAAAA,OAAO,CAAC,KAAD,CAAb,EAApB,CACA,GAAMY,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,SAAMZ,CAAAA,OAAO,CAAC,IAAD,CAAb,EAAnB,CAGA,GAAMa,CAAAA,KAAK,CAAGC,MAAM,CAACC,aAArB,CACA,GAAMC,CAAAA,KAAK,CAAGF,MAAM,CAACG,gBAArB,CACA,GAAMC,CAAAA,YAAY,CAAGJ,MAAM,CAACK,mBAA5B,CAGA,GAAMC,CAAAA,UAAU,2FAAG,iKACE1B,CAAAA,KAAK,CAAC2B,GAAN,CACT1B,GAAG,CAAG,2BAAN,CAAoCE,eAAe,CAACyB,EAApD,CAAyD,GADhD,CAEZ,CACGC,GAAG,CAAEC,KAAK,CAACD,GADd,CAEGE,MAAM,CAAED,KAAK,CAACE,MAFjB,CAGGV,KAAK,CAAEQ,KAAK,CAACG,YAHhB,CAIGC,YAAY,CAAEJ,KAAK,CAACK,OAJvB,CAKGC,gBAAgB,CAAEN,KAAK,CAACO,YAL3B,CAMGC,UAAU,CAAE,CACRC,IAAI,CAAEpC,eAAe,CAACmC,UAAhB,CAA2BC,IADzB,CAERC,OAAO,CAAEV,KAAK,CAACW,OAFP,CAGRC,WAAW,CAAEZ,KAAK,CAACa,WAHX,CAIRC,IAAI,CAAEd,KAAK,CAACe,KAJJ,CAKRX,YAAY,CAAE/B,eAAe,CAACmC,UAAhB,CAA2BJ,YALjC,CANf,CAaGY,OAAO,CAAE,CACLP,IAAI,CAAEpC,eAAe,CAAC2C,OAAhB,CAAwBP,IADzB,CAELC,OAAO,CAAErC,eAAe,CAAC2C,OAAhB,CAAwBN,OAF5B,CAGLE,WAAW,CAAEvC,eAAe,CAAC2C,OAAhB,CAAwBJ,WAHhC,CAILE,IAAI,CAAEzC,eAAe,CAAC2C,OAAhB,CAAwBF,IAJzB,CAKLG,OAAO,CAAE5C,eAAe,CAAC2C,OAAhB,CAAwBC,OAL5B,CAMLC,YAAY,CAAE7C,eAAe,CAAC2C,OAAhB,CAAwBE,YANjC,CAOLC,oBAAoB,CAAE9C,eAAe,CAAC2C,OAAhB,CAAwBG,oBAPzC,CAQLC,uBAAuB,CAAE/C,eAAe,CAAC2C,OAAhB,CAAwBI,uBAR5C,CASLC,oBAAoB,CAAEhD,eAAe,CAAC2C,OAAhB,CAAwBK,oBATzC,CAULC,2BAA2B,CAAEjD,eAAe,CAAC2C,OAAhB,CAAwBM,2BAVhD,CAbZ,CAyBGC,IAAI,CAAE,CACF;AACA/B,KAAK,CAAEQ,KAAK,CAACG,YAFX,CAGFqB,QAAQ,CAAE9B,YAHR,CAzBT,CAFY,CAiCb,CACI+B,OAAO,CAAE,CACL,iCAA2BpC,KAA3B,CADK,CADb,CAjCa,EAsCjBqC,IAtCiB,CAsCZ,SAACC,MAAD,CAAY,CAACC,OAAO,CAACC,GAAR,CAAYF,MAAZ,EAAoB,CAtCrB,CADF,QACVG,GADU,qEAAH,kBAAVlC,CAAAA,UAAU,2CAAhB,CA8CE,GAAMmC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAyB,IAAxBC,CAAAA,WAAwB,2DAAVhC,KAAU,CAC3C,GAAMiC,CAAAA,SAAS,CAAG,EAAlB,CACA,GAAI,OAASD,CAAAA,WAAb,CACEC,SAAS,CAAClC,GAAV,CAAgBC,KAAK,CAACD,GAAN,CAAY,IAAZ,CAAmB,6BAAnC,CAEF,GAAI,UAAYiC,CAAAA,WAAhB,CACEC,SAAS,CAAC/B,MAAV,CAAmBF,KAAK,CAACE,MAAN,CAAe,IAAf,CAAsB,gCAAzC,CAEF,GAAI,gBAAkB8B,CAAAA,WAAtB,CACEC,SAAS,CAAC9B,YAAV,CAAyB,+BAA+B+B,IAA/B,CAAoC/B,YAApC,EACrB,IADqB,CAErB,0BAFJ,CAIF,GAAI,WAAa6B,CAAAA,WAAjB,CACEC,SAAS,CAACtB,OAAV,CAAoBX,KAAK,CAACW,OAAN,CAAgB,IAAhB,CAAuB,iCAA3C,CAEF,GAAI,SAAWqB,CAAAA,WAAf,CACEC,SAAS,CAAClB,KAAV,CAAkBf,KAAK,CAACe,KAAN,CAAc,IAAd,CAAqB,+BAAvC,CAEF,GAAI,gBAAkBiB,CAAAA,WAAtB,CACEC,SAAS,CAAC1B,YAAV,CAAyBP,KAAK,CAACO,YAAN,CAAqB,IAArB,CAA4B,uCAArD,CAEF,GAAI,eAAiByB,CAAAA,WAArB,CACAC,SAAS,CAACpB,WAAV,CAAwB,oCAAoCqB,IAApC,CACtBrB,WADsB,EAGpB,IAHoB,CAIpB,iCAJJ,CAOA,GAAI,WAAamB,CAAAA,WAAjB,CACEC,SAAS,CAAC5B,OAAV,CAAoB,qCAAqC6B,IAArC,CAClB7B,OADkB,EAGhB,IAHgB,CAIhB,yCAJJ,CAOF8B,SAAS,kBAAMF,SAAN,EAAT,CAEA;AACA,GAAID,WAAW,GAAKhC,KAApB,CAA2B,CACzB,MAAOoC,CAAAA,MAAM,CAACC,MAAP,CAAcJ,SAAd,EAAyBK,KAAzB,CAA+B,SAACC,EAAD,QAAQ,CAACA,EAAT,EAA/B,CAAP,CACD,CACF,CA5CC,CA+CD,aAMGzE,OAAO,CAACe,SAAD,CAAYkD,SAAZ,CANV,CACC/B,KADD,UACCA,KADD,CAECwC,iBAFD,UAECA,iBAFD,CAGCC,MAHD,UAGCA,MAHD,CAICN,SAJD,UAICA,SAJD,CAKCO,kBALD,UAKCA,kBALD,CAQD,GAAQ3C,CAAAA,GAAR,CAAuFC,KAAvF,CAAQD,GAAR,CAAaG,MAAb,CAAuFF,KAAvF,CAAaE,MAAb,CAAqBC,YAArB,CAAuFH,KAAvF,CAAqBG,YAArB,CAAkCE,OAAlC,CAAuFL,KAAvF,CAAkCK,OAAlC,CAA0CQ,WAA1C,CAAuFb,KAAvF,CAA0Ca,WAA1C,CAAuDE,KAAvD,CAAuFf,KAAvF,CAAuDe,KAAvD,CAA8DJ,OAA9D,CAAuFX,KAAvF,CAA8DW,OAA9D,CAAsEJ,YAAtE,CAAuFP,KAAvF,CAAsEO,YAAtE,CAEA;AACA;AACA;AACA;AAEA,GAAMoC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,SAAD,CAAe,CAChC,GAAGA,SAAS,GAAKC,SAAjB,CAA2B,CACvB7C,KAAK,CAACD,GAAN,CAAY1B,eAAe,CAAC0B,GAA5B,CACAC,KAAK,CAACE,MAAN,CAAe7B,eAAe,CAAC4B,MAA/B,CACAD,KAAK,CAACG,YAAN,CAAqB9B,eAAe,CAACmB,KAArC,CACAQ,KAAK,CAACK,OAAN,CAAgBhC,eAAe,CAAC+B,YAAhC,CACAJ,KAAK,CAACW,OAAN,CAAgBtC,eAAe,CAACmC,UAAhB,CAA2BE,OAA3C,CACAV,KAAK,CAACa,WAAN,CAAoBxC,eAAe,CAACmC,UAAhB,CAA2BI,WAA/C,CACAZ,KAAK,CAACe,KAAN,CAAc1C,eAAe,CAACmC,UAAhB,CAA2BM,IAAzC,CACAd,KAAK,CAACO,YAAN,CAAqBlC,eAAe,CAACiC,gBAArC,CAEAsB,OAAO,CAACC,GAAR,CAAYe,SAAZ,EACA,MAAO5C,CAAAA,KAAK,CAACD,GAAN,CAAY,EAAnB,CACH,CACD,MAAO6C,CAAAA,SAAS,CAAG,EAAnB,CAEH,CAhBD,CAkBA,GAAME,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAO,CACxBA,CAAC,CAACC,cAAF,GAEA;AAEA,GAAG3E,eAAe,GAAK,EAAvB,CAA0B,CACtB;AACA,GAAI0D,SAAS,EAAb,CAAiB,CACbhE,WAAW,CAAC,MAAD,CAAS,iBAAT,CAA4B,IAA5B,CAAkC,IAAlC,CAAwCiC,KAAxC,CAAX,CACC0B,IADD,CACM,SAACuB,QAAD,CAAc,CAChB,GAAIA,QAAQ,GAAK,KAAb,EAAsBlB,SAAS,EAAnC,CAAuC,CACnCrD,UAAU,CAAC,IAAD,CAAV,CACAU,UAAU,GACb,CAHD,IAGO,CACHV,UAAU,CAAC,KAAD,CAAV,CACAU,UAAU,GACb,CACJ,CATD,EAUH,CACJ,CAdD,IAeI,CACAQ,UAAU,GACVlB,UAAU,CAAC,IAAD,CAAV,CACAU,UAAU,GACV;AACH,CAEJ,CA3BD,CA8BI,GAAM8D,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC1B,GAAIC,CAAAA,GAAG,CAAG,sCAAV,CACA7E,OAAO,CAAC8E,IAAR,CAAaD,GAAb,EACH,CAHD,CAIA,mBACA,yBACS9E,eAAe,GAAKwE,SAApB,EAAiCxE,eAAe,CAACmC,UAAhB,GAA+BqC,SAAhE,cACG,cAAM,SAAS,CAAC,qBAAhB,CAAsC,QAAQ,CAAEC,YAAhD,wBAEI,aAAK,SAAS,CAAC,iBAAf,wBAEE,KAAC,SAAD,EACA,SAAS,KADT,CAEA,SAAS,CAAC,iBAFV,CAGA,EAAE,CAAC,gBAHH,CAIA,OAAO,CAAC,UAJR,CAKA,KAAK,CAAE,kBALP,CAMA,IAAI,CAAC,KANL,CAOA,KAAK,CAAEH,YAAY,CAAC3C,KAAK,CAACD,GAAP,CAPnB,CAQA,QAAQ,CAAEyC,iBARV,CASA,QAAQ,KATR,EAFF,cAYE,YAAK,SAAS,CAAC,QAAf,UAAyBC,MAAM,CAAC1C,GAAhC,EAZF,GAFJ,cAkBI,aAAK,SAAS,CAAC,iBAAf,wBAEE,KAAC,SAAD,EACE,SAAS,KADX,CAEE,SAAS,CAAC,iBAFZ,CAGE,EAAE,CAAC,gBAHL,CAIE,OAAO,CAAC,UAJV,CAKE,KAAK,CAAE,wBALT,CAME,IAAI,CAAC,QANP,CAOE,KAAK,CAAE4C,YAAY,CAAC3C,KAAK,CAACE,MAAP,CAPrB,CAQE,QAAQ,CAAEsC,iBARZ,CASE,QAAQ,KATV,EAFF,cAYI,YAAK,SAAS,CAAC,QAAf,UAAyBC,MAAM,CAACvC,MAAhC,EAZJ,GAlBJ,cAiCI,aAAK,SAAS,CAAC,iBAAf,wBACI,KAAC,SAAD,EACA,SAAS,KADT,CAEA,SAAS,CAAC,iBAFV,CAGA,EAAE,CAAC,gBAHH,CAIA,OAAO,CAAC,UAJR,CAKA,KAAK,CAAE,SALP,CAMA,IAAI,CAAC,SANL,CAOA,KAAK,CAAEyC,YAAY,CAAC3C,KAAK,CAACW,OAAP,CAPnB,CAQA,QAAQ,CAAE6B,iBARV,CASA,QAAQ,KATR,EADJ,cAWG,YAAK,SAAS,CAAC,QAAf,UAAyBC,MAAM,CAAC9B,OAAhC,EAXH,GAjCJ,cA8CI,aAAK,SAAS,CAAC,mBAAf,wBACI,aAAK,SAAS,CAAC,iBAAf,wBACI,KAAC,SAAD,EACA,SAAS,KADT,CAEA,SAAS,CAAC,iBAFV,CAGA,EAAE,CAAC,gBAHH,CAIA,OAAO,CAAC,UAJR,CAKA,KAAK,CAAE,aALP,CAMA,IAAI,CAAC,aANL,CAOA,KAAK,CAAEgC,YAAY,CAAC3C,KAAK,CAACa,WAAP,CAPnB,CAQA,QAAQ,CAAE2B,iBARV,CASA,QAAQ,KATR,EADJ,cAWI,YAAK,SAAS,CAAC,QAAf,UAAyBC,MAAM,CAAC5B,WAAhC,EAXJ,GADJ,cAgBI,aAAK,SAAS,CAAC,iBAAf,wBACI,KAAC,SAAD,EACA,SAAS,KADT,CAEA,SAAS,CAAC,iBAFV,CAGA,EAAE,CAAC,gBAHH,CAIA,OAAO,CAAC,UAJR,CAKA,KAAK,CAAE,OALP,CAMA,IAAI,CAAC,OANL,CAOA,KAAK,CAAE8B,YAAY,CAAC3C,KAAK,CAACe,KAAP,CAPnB,CAQA,QAAQ,CAAEyB,iBARV,CASA,QAAQ,KATR,EADJ,cAWI,YAAK,SAAS,CAAC,QAAf,UAAyBC,MAAM,CAAC1B,KAAhC,EAXJ,GAhBJ,GA9CJ,cA4EI,aAAK,SAAS,CAAC,iBAAf,wBACI,KAAC,SAAD,EACA,SAAS,KADT,CAEA,SAAS,CAAC,iBAFV,CAGA,EAAE,CAAC,gBAHH,CAIA,OAAO,CAAC,UAJR,CAKA,KAAK,CAAE,cALP,CAMA,IAAI,CAAC,cANL,CAOA,KAAK,CAAEf,KAAK,CAACG,YAPb,CAQA,QAAQ,CAAEqC,iBARV,CASA,QAAQ,KATR,EADJ,cAWI,YAAK,SAAS,CAAC,QAAf,UAAyBC,MAAM,CAACtC,YAAhC,EAXJ,GA5EJ,cA0FI,aAAK,SAAS,CAAC,mBAAf,wBACI,aAAK,SAAS,CAAC,iBAAf,wBACI,KAAC,SAAD,EACA,SAAS,KADT,CAEA,SAAS,CAAC,iBAFV,CAGA,EAAE,CAAC,gBAHH,CAIA,OAAO,CAAC,UAJR,CAKA,KAAK,CAAE,iBALP,CAMA,KAAK,CAAEwC,YAAY,CAAC3C,KAAK,CAACO,YAAP,CANnB,CAOA,IAAI,CAAC,cAPL,CAQA,QAAQ,CAAEiC,iBARV,CASA,QAAQ,KATR,EADJ,cAWI,YAAK,SAAS,CAAC,QAAf,UAAyBC,MAAM,CAAClC,YAAhC,EAXJ,GADJ,cAeI,aAAK,SAAS,CAAC,iBAAf,wBACI,KAAC,SAAD,EACA,SAAS,KADT,CAEA,SAAS,CAAC,iBAFV,CAGA,EAAE,CAAC,gBAHH,CAIA,OAAO,CAAC,UAJR,CAKA,KAAK,CAAE,8BALP,CAMA,IAAI,CAAC,SANL,CAOA,KAAK,CAAEP,KAAK,CAACK,OAPb,CAQA,QAAQ,CAAEmC,iBARV,CASA,QAAQ,KATR,EADJ,cAWI,YAAK,SAAS,CAAC,QAAf,UAAyBC,MAAM,CAACpC,OAAhC,EAXJ,GAfJ,GA1FJ,cAuHI,YAAK,SAAS,CAAC,kBAAf,uBACI,eAAQ,SAAS,CAAC,iBAAlB,CAAoC,IAAI,CAAC,QAAzC,yBADJ,EAvHJ,cA4HI,KAAC,aAAD,EACI,WAAW,CAAElB,WADjB,CAEI,IAAI,CAAEZ,IAFV,CAGI,KAAK,cACD,2BACKE,OAAO,CAAG,QAAH,CAAc,MAD1B,cAEI,UACI,SAAS,WACFA,OAAO,CAAG,mBAAH,CAAyB,qBAD9B,CADb,CAGI,KAAK,CAAE,CAAC4E,KAAK,CAAE,SAAR,CAAmBC,UAAU,CAAE,MAA/B,CAHX,EAFJ,GAJR,UAYK7E,OAAO,CAAG,6BAAH,CAAmC,gDAZ/C,EA5HJ,GADH,CA4II,IA7Ib,EADA,CAmJP,CAvUD,CAwUA,cAAeL,CAAAA,mBAAf","sourcesContent":["import React, {useHistory} from \"react-router-dom\";\nimport  { useState, useEffect } from \"react\";\nimport useForm from \"../../../hooks/useForm\";\n import {sendrequest} from \"../../../middlewares/request\";\nimport ModalBootsrap from \"../modal/Modal\";\nimport {TextField} from '@material-ui/core';\nimport axios from \"axios\";\nimport {URL} from \"../../../middlewares/request\";\n\nimport './dirigeant.css'\n\n\nconst UpdateFormDirigeant = ({restaurantOwner}) => {\n\n    const history = useHistory();\n\n    const [show, setShow] = useState(false);\n    const [success, setSuccess] = useState(false);\n    const [dirigeant, setDirigeant] = useState([]);\n    const [initState, setInitState] = useState([]);\n    const [infoRestaurant, setInfoRestaurant] = useState([]);\n    const [infoEntreprise, setInfoEntreprise] = useState([]);\n\n    const handleClose = () => setShow(false);\n    const handleShow = () => setShow(true);\n\n\n    const token = window.$token_access;\n    const email = window.$email_dirigeant;\n    const password_dir = window.$password_dirigeant;\n\n\n    const updateData = async () => {\n       const res = await axios.put(\n                URL + \"accounts/restaurantowner/\" + restaurantOwner.id + \"/\"\n            ,{\n                nom: state.nom,\n                prénom: state.prenom,\n                email: state.adresse_mail,\n                phone_number: state.num_tel,\n                company_position: state.poste_occupe,\n                restaurant: {\n                    name: restaurantOwner.restaurant.name,\n                    address: state.adresse,\n                    postal_code: state.code_postal,\n                    city: state.ville,\n                    phone_number: restaurantOwner.restaurant.phone_number\n                },\n                company: {\n                    name: restaurantOwner.company.name,\n                    address: restaurantOwner.company.address,\n                    postal_code: restaurantOwner.company.postal_code,\n                    city: restaurantOwner.company.city,\n                    capital: restaurantOwner.company.capital,\n                    SIRET_number: restaurantOwner.company.SIRET_number,\n                    retirement_fund_name: restaurantOwner.company.retirement_fund_name,\n                    retirement_fund_address: restaurantOwner.company.retirement_fund_address,\n                    retirement_fund_city: restaurantOwner.company.retirement_fund_city,\n                    retirement_fund_postal_code: restaurantOwner.company.retirement_fund_postal_code\n                },\n                user: {\n                    //username: state.adresse_mail,\n                    email: state.adresse_mail,\n                    password: password_dir,\n                }\n            },\n            {\n                headers: {\n                    'Authorization': `Bearer ${token}`\n                }\n            }\n      ).then((result) => {console.log(result)});\n\n\n    }\n\n\n\n      const estValide = (fieldValues = state) => {\n      const validator = {};\n      if (\"nom\" in fieldValues)\n        validator.nom = state.nom ? null : \"Le champ nom est obligatore\";\n\n      if (\"prenom\" in fieldValues)\n        validator.prenom = state.prenom ? null : \"Le champ prénom est obligatore\";\n\n      if (\"adresse_mail\" in fieldValues)\n        validator.adresse_mail = /([a-zA-Z0-9-_.+]{4,})@.+\\..+/.test(adresse_mail)\n          ? null\n          : \"Le mail n'est pas valide\";\n\n      if (\"adresse\" in fieldValues)\n        validator.adresse = state.adresse ? null : \"Le champ adresse est obligatore\";\n\n      if (\"ville\" in fieldValues)\n        validator.ville = state.ville ? null : \"Le champ ville est obligatore\";\n\n      if (\"poste_occupe\" in fieldValues)\n        validator.poste_occupe = state.poste_occupe ? null : \"Le champ poste occupée est obligatore\";\n\n      if (\"code_postal\" in fieldValues)\n      validator.code_postal = /^(([0-8][0-9])|(9[0-5]))[0-9]{3}$/.test(\n        code_postal\n      )\n        ? null\n        : \"Le code postal n'est pas valide\";\n\n\n      if (\"num_tel\" in fieldValues)\n        validator.num_tel = /^(0|\\+33)[1-9]([-. ]?[0-9]{2}){4}$/.test(\n          num_tel\n        )\n          ? null\n          : \"Le numéro de téléphone n'est pas valide\";\n\n\n      setErrors({ ...validator });\n\n      // retourne boolean si et seulement si on passe un parametre pour la fonction\n      if (fieldValues === state) {\n        return Object.values(validator).every((el) => !el);\n      }\n    };\n\n\n     const {\n      state,\n      handleInputChange,\n      errors,\n      setErrors,\n      reinitialiserState,\n    } = useForm(initState, estValide);\n\n    const { nom, prenom, adresse_mail,num_tel,code_postal, ville, adresse,poste_occupe } = state\n\n    //state.prenom = restaurantOwner.prénom\n    //Fonction permettant d'afficher les données récupérés\n    //contenant => input modifiable\n    //contenue => donnée à afficher\n\n    const preAffichage = (contenant) => {\n        if(contenant === undefined){\n            state.nom = restaurantOwner.nom\n            state.prenom = restaurantOwner.prénom\n            state.adresse_mail = restaurantOwner.email\n            state.num_tel = restaurantOwner.phone_number\n            state.adresse = restaurantOwner.restaurant.address\n            state.code_postal = restaurantOwner.restaurant.postal_code\n            state.ville = restaurantOwner.restaurant.city\n            state.poste_occupe = restaurantOwner.company_position\n\n            console.log(contenant)\n            return state.nom + \"\"\n        }\n        return contenant + \"\"\n\n    }\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n\n        // Cas où le dirigeant entre ces informations pour la 1ere fois\n\n        if(restaurantOwner === []){\n            //reinitialiserState();\n            if (estValide()) {\n                sendrequest(\"post\", \"main/dirigeant/\", null, null, state)\n                .then((response) => {\n                    if (response !== false && estValide()) {\n                        setSuccess(true);\n                        handleShow();\n                    } else {\n                        setSuccess(false);\n                        handleShow();\n                    }\n                })\n            }\n        }\n        else{\n            updateData();\n            setSuccess(true);\n            handleShow();\n            //RedirectionInfo();\n        }\n\n    };\n\n\n        const RedirectionInfo = () => {\n            let url = \"/admin/mon-compte/infos-personnelles\";\n            history.push(url);\n        }\n        return (\n        <>\n                {restaurantOwner !== undefined && restaurantOwner.restaurant !== undefined ?\n                    <form className=\"dirigeant_container\" onSubmit={handleSubmit}>\n\n                        <div className='dirigeant_label'>\n\n                          <TextField\n                          fullWidth\n                          className='dirigeant_input'\n                          id=\"outlined-basic\"\n                          variant=\"outlined\"\n                          label =\"Nom du dirigeant\"\n                          name='nom'\n                          value={preAffichage(state.nom)}\n                          onChange={handleInputChange}\n                          required/>\n                          <div className='errors'>{errors.nom}</div>\n                        </div>\n\n\n                        <div className='dirigeant_label'>\n\n                          <TextField\n                            fullWidth\n                            className='dirigeant_input'\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            label =\"Prénom du dirigeant\"\n                            name='prenom'\n                            value={preAffichage(state.prenom)}\n                            onChange={handleInputChange}\n                            required/>\n                            <div className='errors'>{errors.prenom}</div>\n                        </div>\n\n                        <div className='dirigeant_label'>\n                            <TextField\n                            fullWidth\n                            className='dirigeant_input'\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            label =\"Adresse\"\n                            name='adresse'\n                            value={preAffichage(state.adresse)}\n                            onChange={handleInputChange}\n                            required/>\n                           <div className='errors'>{errors.adresse}</div>\n                        </div>\n                        <div className='dirigeant_adresse'>\n                            <div className='dirigeant_label'>\n                                <TextField\n                                fullWidth\n                                className='dirigeant_input'\n                                id=\"outlined-basic\"\n                                variant=\"outlined\"\n                                label =\"Code postal\"\n                                name='code_postal'\n                                value={preAffichage(state.code_postal)}\n                                onChange={handleInputChange}\n                                required/>\n                                <div className='errors'>{errors.code_postal}</div>\n                            </div>\n\n\n                            <div className='dirigeant_label'>\n                                <TextField\n                                fullWidth\n                                className='dirigeant_input'\n                                id=\"outlined-basic\"\n                                variant=\"outlined\"\n                                label =\"Ville\"\n                                name='ville'\n                                value={preAffichage(state.ville)}\n                                onChange={handleInputChange}\n                                required/>\n                                <div className='errors'>{errors.ville}</div>\n                            </div>\n                          </div>\n                        <div className='dirigeant_label'>\n                            <TextField\n                            fullWidth\n                            className='dirigeant_input'\n                            id=\"outlined-basic\"\n                            variant=\"outlined\"\n                            label =\"Adresse mail\"\n                            name='adresse_mail'\n                            value={state.adresse_mail}\n                            onChange={handleInputChange}\n                            required/>\n                            <div className='errors'>{errors.adresse_mail}</div>\n                        </div>\n\n                        <div className='dirigeant_adresse'>\n                            <div className='dirigeant_label'>\n                                <TextField\n                                fullWidth\n                                className='dirigeant_input'\n                                id=\"outlined-basic\"\n                                variant=\"outlined\"\n                                label =\"Poste occupé\"\n                                value={preAffichage(state.poste_occupe)}\n                                name='poste_occupe'\n                                onChange={handleInputChange}\n                                required/>\n                                <div className='errors'>{errors.poste_occupe}</div>\n                            </div>\n\n                            <div className='dirigeant_label'>\n                                <TextField\n                                fullWidth\n                                className='dirigeant_input'\n                                id=\"outlined-basic\"\n                                variant=\"outlined\"\n                                label =\"Numéro de téléphone\"\n                                name='num_tel'\n                                value={state.num_tel}\n                                onChange={handleInputChange}\n                                required/>\n                                <div className='errors'>{errors.num_tel}</div>\n                            </div>\n                          </div>\n                        <div className='dirigeant_button'>\n                            <button className=\"registre_button\" type=\"submit\">Enregistrer</button>\n                            {/*<button className=\"edit_button\" type=\"submit\">Modifier</button>*/}\n                        </div>\n\n                        <ModalBootsrap\n                            handleClose={handleClose}\n                            show={show}\n                            title={\n                                <>\n                                    {success ? \"Envoyé\" : \"Oups\"}\n                                    <i\n                                        className={\n                                            `${success ? \" fas fa-thumbs-up\" : \" fas fa-thumbs-down\"}`}\n                                        style={{color: \"#4caf50\", marginLeft: \"1rem\"}}></i>\n                                </>\n                            }>\n                            {success ? \"Enregistrement avec succès.\" : \"Une erreur s'est produite, veuillez réessayer.\"}\n                        </ModalBootsrap>\n                    </form>\n                    :null}\n            </>\n\n        );\n\n}\nexport default UpdateFormDirigeant;\n"]},"metadata":{},"sourceType":"module"}