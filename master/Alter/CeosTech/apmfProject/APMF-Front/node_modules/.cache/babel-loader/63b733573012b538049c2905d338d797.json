{"ast":null,"code":"var _jsxFileName = \"/home/christopher/Documents/Alter/apmfProject/APMF-Front/src/components/app/Association/Paiement/index.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport useForm from \"../../../../hooks/useForm\"; //Form has already in Hooks\n\nimport { Button, FormControl, IconButton, Input, InputLabel, makeStyles } from \"@material-ui/core\";\nimport Modal from \"../../../modal/Modal\";\nimport NavigateNextIcon from \"@material-ui/icons/NavigateNext\";\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport { sendrequest } from \"../../../../middlewares/request\";\nimport \"./styles.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    justifyContent: \"center\"\n  },\n  margin: {\n    margin: theme.spacing(1, 0)\n  },\n  marginLeftRight: {\n    marginRight: theme.spacing(1),\n    marginLeft: theme.spacing(1)\n  },\n  withoutLabel: {\n    marginTop: theme.spacing(3)\n  },\n  textField: {\n    width: \"25ch\"\n  },\n  buttonIcon: {\n    paddingLeft: 1\n  },\n  border: {\n    \"& label.Mui-focused\": {\n      color: \"#ccc\"\n    },\n    \"& .MuiInput-underline:after\": {\n      borderBottomColor: \"#ccc\"\n    },\n    \"& .MuiOutlinedInput-root\": {\n      \"&:hover fieldset\": {\n        borderColor: \"#ccc\"\n      },\n      \"&.Mui-focused fieldset\": {\n        borderColor: \"#ccc\"\n      }\n    }\n  }\n})); // Component used for Adhesion and Don.\n// url are passed as props\n// dataUser will be displayed in the bill informations and can be modified. They will then be sent to Stripe for billing informations\n// dataRegister are the data concerning the donation informations. They will be sent to the API to register the donation\n// setPayment will be used to go back to the form page\n// setState will be used to set the currentStep of the form page to 1, to the beginning\n\nconst Paiement = ({\n  dataUser,\n  urlRegister,\n  urlStripe,\n  dataRegister,\n  setState,\n  setPayment\n}) => {\n  _s();\n\n  //console.log(\"data after payement called\", dataRegister);\n  // With location we can retrieve the kind of delivery chosen (was passed in props of history)\n  const classes = useStyles();\n  const [steps, setSteps] = useState(1);\n  const [error, setError] = useState(null);\n  const [montant, setMontant] = useState(dataUser.donation);\n  const [disabled, setDisabled] = useState(true);\n  const [processing, setProcessing] = useState(false);\n  const [succeeded, setSucceeded] = useState(false);\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const estValide = (fieldValues = state) => {\n    const validator = {};\n    if (\"lastName\" in fieldValues) validator.lastName = state.lastName ? null : \"le champ nom est obligatoire\";\n    if (\"firstName\" in fieldValues) validator.firstName = state.firstName ? null : \"le champ prénom est obligatoire\";\n    if (\"mail\" in fieldValues) validator.mail = /([a-zA-Z0-9-_.+]{4,})@.+\\..+/.test(state.mail) ? null : \"L'email n'est pas valide\";\n    if (\"phone\" in fieldValues) validator.phone = /(?:(\\+(\\d{1,2})?)[ -]?)?\\(?(?<first>\\d{3})\\)?[-\\s]?(\\d{3})[- ]?(\\d{4})/.test(state.phone) ? null : \"Le numéro de téléphone n'est pas valide\";\n    if (\"address\" in fieldValues) validator.address = state.address ? null : \"le champ adresse est obligatoire\";\n    if (\"city\" in fieldValues) validator.city = state.city ? null : \"le champ ville est obligatoire\";\n    if (\"postalCode\" in fieldValues) validator.postalCode = /\\d+/.test(state.postalCode) ? null : \"Le code postal n'est pas valide\";\n    setErrors({ ...validator\n    }); // retourne boolean si et seulement si on passe un parametre pour la fonction\n\n    if (fieldValues === state) {\n      return Object.values(validator).every(el => !el);\n    }\n  }; //  dataUser is the data filled up by the user in the form, we give them as an initial state for this form. The user is then free to change them\n\n\n  const {\n    state,\n    handleInputChange,\n    errors,\n    setErrors,\n    reinitialiserState\n  } = useForm(dataUser, estValide);\n  const {\n    address,\n    firstName,\n    lastName,\n    postalCode,\n    city,\n    phone,\n    mail,\n    newsletter\n  } = state; // go to step 2 of the payment\n\n  const handleSubmit = e => {\n    e.preventDefault();\n\n    if (estValide()) {\n      setSteps(2);\n    }\n  };\n\n  const handleChange = event => {\n    // Listen for changes in CardElement\n    // and display any errors as the customer types their card details\n    setDisabled(event.empty);\n    setError(event.error ? event.error.message : \"\");\n  }; // Variables and methods to set if the form is valid or not, and display a modal window with the result of the request. Used when the form is submitted\n\n\n  const [success, setSuccess] = useState(false);\n  const [show, setShow] = useState(false); // If success of the request, Will close the modal, go back to the first page of the form\n\n  const handleClose = () => {\n    if (success) {\n      setShow(false);\n      setPayment(false);\n      setState({ ...state,\n        currentStep: 1\n      });\n    } else {\n      setShow(false);\n    }\n  };\n\n  const handleShow = () => setShow(true); // Fonction liée au paiement ainsi qu'à l'enregistrement des infos du clients\n\n\n  const registerDon = async () => {\n    const data = dataRegister;\n    console.log(data);\n    const response = await sendrequest(\"post\", urlRegister, data);\n\n    if (response !== false) {\n      setSuccess(true);\n      handleShow();\n      reinitialiserState(); //history.replace(\"/felicitation\", { payer: true });\n    } else {\n      setSuccess(false);\n      handleShow();\n      setError(\"Un problème s'est produit lors du paiement, veuillez réessayer\");\n    }\n  };\n\n  const Payer = async e => {\n    e.preventDefault();\n    setProcessing(true);\n    const {\n      data\n    } = await sendrequest(\"post\", urlStripe, {\n      amount: parseInt((parseInt(montant) * 100).toFixed(2), 10),\n      email: mail\n    }); // // *100 : stripe prend l'unité en centimes\n    // // 3€ -> 300 centimes\n\n    const billing_details = {\n      name: lastName + \" \" + firstName,\n      address: {\n        city,\n        country: \"fr\",\n        state: null,\n        line1: address,\n        line2: null,\n        postal_code: postalCode\n      },\n      email: mail,\n      phone\n    };\n    await stripe.confirmCardPayment(data.clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details\n      }\n    }).then(res => {\n      setError(null);\n      setProcessing(false);\n      setDisabled(false);\n      setSucceeded(true);\n      registerDon();\n    }).catch(err => {\n      setError(`Paiement échoué: ${err.message}`);\n      setProcessing(false);\n      setSuccess(false);\n      handleShow();\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"paiment\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"paiement__container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Paiement\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"paiement__process\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"paiement__process--option1 paiement__process--options active\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Adresse de facturation\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"paiement__process--option2 paiement__process--options \" + (steps === 2 ? \"active\" : \"\"),\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"D\\xE9tails de paiement\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 9\n      }, this), steps === 1 ? /*#__PURE__*/_jsxDEV(\"form\", {\n        noValidate: true,\n        autoComplete: \"off\",\n        onSubmit: handleSubmit,\n        style: {\n          flexDirection: \"column\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          className: `${classes.margin} ${classes.border} `,\n          children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n            children: \"Nom\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            value: lastName,\n            name: \"lastName\",\n            onChange: handleInputChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          children: errors.lastName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          className: `${classes.margin} ${classes.border} `,\n          children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n            children: \"Prenom\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            value: firstName,\n            name: \"firstName\",\n            onChange: handleInputChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          children: errors.firstName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          className: `${classes.margin} ${classes.border} `,\n          children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n            children: \"Adresse Mail\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            type: \"email\",\n            name: \"mail\",\n            onChange: handleInputChange,\n            value: mail,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          children: errors.mail\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          className: `${classes.margin} ${classes.border} `,\n          children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n            children: \"Num\\xE9ro de T\\xE9l\\xE9phone\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            value: phone,\n            name: \"phone\",\n            onChange: handleInputChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          children: errors.phone\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          className: `${classes.margin} ${classes.border} `,\n          children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n            children: \"Adresse\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            value: address,\n            name: \"address\",\n            onChange: handleInputChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          children: errors.address\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: \"flex\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(FormControl, {\n            fullWidth: true,\n            className: `${classes.margin} ${classes.border} ${classes.marginLeftRight}`,\n            children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n              children: \"Ville\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 358,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              value: city,\n              name: \"city\",\n              onChange: handleInputChange,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"error\",\n              children: errors.city\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 365,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n            fullWidth: true,\n            className: `${classes.margin} ${classes.border} ${classes.marginLeftRight}`,\n            children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n              children: \"Code Postal\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              value: postalCode,\n              name: \"postalCode\",\n              onChange: handleInputChange,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"error\",\n              children: errors.postalCode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"submit\",\n          variant: \"contained\",\n          color: \"primary\",\n          className: \"paiement--btn\",\n          endIcon: /*#__PURE__*/_jsxDEV(NavigateNextIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 24\n          }, this),\n          children: \"Suivant\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"paiement__details\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"paiement__details__recapitualitfs\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"R\\xE9capitulatif de don\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"paiement__details__recapitualitfs-total\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Montant\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"paiement__details__recapitualitfs-total-prix\",\n              children: [montant, \"\\u20AC\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 398,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"paiement__details__modePaiement\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Paiement s\\xE9curis\\xE9 par carte bancaire\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"CB et VISA accept\\xE9es\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            className: \"paiement__form\",\n            children: [/*#__PURE__*/_jsxDEV(CardElement, {\n              id: \"card-element\",\n              onChange: handleChange,\n              options: cardStyle\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 408,\n              columnNumber: 17\n            }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"paiement__details__error\",\n              children: [\"* \", error]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 414,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              onClick: Payer,\n              disabled: montant <= 1 || processing || disabled || succeeded,\n              type: \"submit\",\n              variant: \"contained\",\n              color: \"primary\",\n              className: \"paiement--btn-payer\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"paiement--btn-payer-text\",\n                children: [\"Donner \", montant, \"\\u20AC\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 424,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 416,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"paiement__details__securise\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-lock\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 17\n            }, this), \" Paiement 100% s\\xE9curis\\xE9\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"paiement__back active\",\n        children: /*#__PURE__*/_jsxDEV(IconButton, {\n          onClick: () => {\n            if (steps === 2) setSteps(1);else setPayment(false);\n          },\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-arrow-left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      handleClose: handleClose,\n      show: show,\n      title: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [success ? \"Envoyé\" : \"Erreur\", /*#__PURE__*/_jsxDEV(\"i\", {\n          className: `${success ? \" fas fa-thumbs-up\" : \" fas fa-thumbs-down\"}`,\n          style: {\n            color: \"var(--primary-color)\",\n            marginLeft: \"1rem\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true),\n      children: success ? dataRegister.donneur ? \"Félicitations ! Nous avons bien reçu votre don et vous remercions.\" : \"Une erreur s'est produite, veuillez réessayer.\" ? \"Félicitations ! Nous avons bien reçu votre adhésion et vous remercions.\" : \"Une erreur s'est produite, veuillez réessayer.\" : \"\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 453,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 251,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Paiement, \"yo97lMWaIntNMVAeREtmC792TT8=\", false, function () {\n  return [useStyles, useStripe, useElements, useForm];\n});\n\n_c = Paiement;\nconst cardStyle = {\n  style: {\n    base: {\n      color: \"#32325d\",\n      fontFamily: \"Roboto, Open Sans, Segoe UI, sans-serif\",\n      fontSmoothing: \"antialiased\",\n      fontSize: \"16px\",\n      \"::placeholder\": {\n        color: \"#aaa\",\n        backgroundColor: \"#fff\"\n      },\n      \":-webkit-autofill\": {\n        color: \"#fff\"\n      },\n      \":focus\": {\n        color: \"#aaa\"\n      }\n    },\n    invalid: {\n      color: \"#fa755a\",\n      iconColor: \"#fa755a\"\n    }\n  },\n  hidePostalCode: true\n};\nexport default Paiement;\n\nvar _c;\n\n$RefreshReg$(_c, \"Paiement\");","map":{"version":3,"sources":["/home/christopher/Documents/Alter/apmfProject/APMF-Front/src/components/app/Association/Paiement/index.js"],"names":["useState","useEffect","useForm","Button","FormControl","IconButton","Input","InputLabel","makeStyles","Modal","NavigateNextIcon","CardElement","useStripe","useElements","sendrequest","useStyles","theme","root","display","flexWrap","justifyContent","margin","spacing","marginLeftRight","marginRight","marginLeft","withoutLabel","marginTop","textField","width","buttonIcon","paddingLeft","border","color","borderBottomColor","borderColor","Paiement","dataUser","urlRegister","urlStripe","dataRegister","setState","setPayment","classes","steps","setSteps","error","setError","montant","setMontant","donation","disabled","setDisabled","processing","setProcessing","succeeded","setSucceeded","stripe","elements","estValide","fieldValues","state","validator","lastName","firstName","mail","test","phone","address","city","postalCode","setErrors","Object","values","every","el","handleInputChange","errors","reinitialiserState","newsletter","handleSubmit","e","preventDefault","handleChange","event","empty","message","success","setSuccess","show","setShow","handleClose","currentStep","handleShow","registerDon","data","console","log","response","Payer","amount","parseInt","toFixed","email","billing_details","name","country","line1","line2","postal_code","confirmCardPayment","clientSecret","payment_method","card","getElement","then","res","catch","err","flexDirection","cardStyle","donneur","style","base","fontFamily","fontSmoothing","fontSize","backgroundColor","invalid","iconColor","hidePostalCode"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport useForm from \"../../../../hooks/useForm\"; //Form has already in Hooks\nimport {\n  Button,\n  FormControl,\n  IconButton,\n  Input,\n  InputLabel,\n  makeStyles,\n} from \"@material-ui/core\";\nimport Modal from \"../../../modal/Modal\";\nimport NavigateNextIcon from \"@material-ui/icons/NavigateNext\";\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\n\nimport { sendrequest } from \"../../../../middlewares/request\";\nimport \"./styles.css\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    justifyContent: \"center\",\n  },\n  margin: {\n    margin: theme.spacing(1, 0),\n  },\n  marginLeftRight: {\n    marginRight: theme.spacing(1),\n    marginLeft: theme.spacing(1),\n  },\n  withoutLabel: {\n    marginTop: theme.spacing(3),\n  },\n  textField: {\n    width: \"25ch\",\n  },\n\n  buttonIcon: {\n    paddingLeft: 1,\n  },\n\n  border: {\n    \"& label.Mui-focused\": {\n      color: \"#ccc\",\n    },\n    \"& .MuiInput-underline:after\": {\n      borderBottomColor: \"#ccc\",\n    },\n\n    \"& .MuiOutlinedInput-root\": {\n      \"&:hover fieldset\": {\n        borderColor: \"#ccc\",\n      },\n      \"&.Mui-focused fieldset\": {\n        borderColor: \"#ccc\",\n      },\n    },\n  },\n}));\n\n// Component used for Adhesion and Don.\n// url are passed as props\n// dataUser will be displayed in the bill informations and can be modified. They will then be sent to Stripe for billing informations\n// dataRegister are the data concerning the donation informations. They will be sent to the API to register the donation\n// setPayment will be used to go back to the form page\n// setState will be used to set the currentStep of the form page to 1, to the beginning\n\nconst Paiement = ({\n  dataUser,\n  urlRegister,\n  urlStripe,\n  dataRegister,\n  setState,\n  setPayment,\n}) => {\n  //console.log(\"data after payement called\", dataRegister);\n  // With location we can retrieve the kind of delivery chosen (was passed in props of history)\n  const classes = useStyles();\n  const [steps, setSteps] = useState(1);\n  const [error, setError] = useState(null);\n  const [montant, setMontant] = useState(dataUser.donation);\n  const [disabled, setDisabled] = useState(true);\n  const [processing, setProcessing] = useState(false);\n  const [succeeded, setSucceeded] = useState(false);\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const estValide = (fieldValues = state) => {\n    const validator = {};\n    if (\"lastName\" in fieldValues)\n      validator.lastName = state.lastName\n        ? null\n        : \"le champ nom est obligatoire\";\n    if (\"firstName\" in fieldValues)\n      validator.firstName = state.firstName\n        ? null\n        : \"le champ prénom est obligatoire\";\n\n    if (\"mail\" in fieldValues)\n      validator.mail = /([a-zA-Z0-9-_.+]{4,})@.+\\..+/.test(state.mail)\n        ? null\n        : \"L'email n'est pas valide\";\n\n    if (\"phone\" in fieldValues)\n      validator.phone =\n        /(?:(\\+(\\d{1,2})?)[ -]?)?\\(?(?<first>\\d{3})\\)?[-\\s]?(\\d{3})[- ]?(\\d{4})/.test(\n          state.phone\n        )\n          ? null\n          : \"Le numéro de téléphone n'est pas valide\";\n\n    if (\"address\" in fieldValues)\n      validator.address = state.address\n        ? null\n        : \"le champ adresse est obligatoire\";\n\n    if (\"city\" in fieldValues)\n      validator.city = state.city ? null : \"le champ ville est obligatoire\";\n\n    if (\"postalCode\" in fieldValues)\n      validator.postalCode = /\\d+/.test(state.postalCode)\n        ? null\n        : \"Le code postal n'est pas valide\";\n\n    setErrors({ ...validator });\n\n    // retourne boolean si et seulement si on passe un parametre pour la fonction\n    if (fieldValues === state) {\n      return Object.values(validator).every((el) => !el);\n    }\n  };\n\n  //  dataUser is the data filled up by the user in the form, we give them as an initial state for this form. The user is then free to change them\n  const { state, handleInputChange, errors, setErrors, reinitialiserState } =\n    useForm(dataUser, estValide);\n\n  const {\n    address,\n    firstName,\n    lastName,\n    postalCode,\n    city,\n    phone,\n    mail,\n    newsletter,\n  } = state;\n\n  // go to step 2 of the payment\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    if (estValide()) {\n      setSteps(2);\n    }\n  };\n\n  const handleChange = (event) => {\n    // Listen for changes in CardElement\n    // and display any errors as the customer types their card details\n    setDisabled(event.empty);\n    setError(event.error ? event.error.message : \"\");\n  };\n\n  // Variables and methods to set if the form is valid or not, and display a modal window with the result of the request. Used when the form is submitted\n  const [success, setSuccess] = useState(false);\n  const [show, setShow] = useState(false);\n\n  // If success of the request, Will close the modal, go back to the first page of the form\n  const handleClose = () => {\n    if (success) {\n      setShow(false);\n      setPayment(false);\n      setState({\n        ...state,\n        currentStep: 1,\n      });\n    } else {\n      setShow(false);\n    }\n  };\n\n  const handleShow = () => setShow(true);\n\n  // Fonction liée au paiement ainsi qu'à l'enregistrement des infos du clients\n  const registerDon = async () => {\n    const data = dataRegister;\n    console.log(data);\n    const response = await sendrequest(\"post\", urlRegister, data);\n    if (response !== false) {\n      setSuccess(true);\n      handleShow();\n      reinitialiserState();\n      //history.replace(\"/felicitation\", { payer: true });\n    } else {\n      setSuccess(false);\n      handleShow();\n      setError(\n        \"Un problème s'est produit lors du paiement, veuillez réessayer\"\n      );\n    }\n  };\n\n  const Payer = async (e) => {\n    e.preventDefault();\n    setProcessing(true);\n\n    const { data } = await sendrequest(\"post\", urlStripe, {\n      amount: parseInt((parseInt(montant) * 100).toFixed(2), 10),\n      email: mail,\n    });\n    // // *100 : stripe prend l'unité en centimes\n    // // 3€ -> 300 centimes\n\n    const billing_details = {\n      name: lastName + \" \" + firstName,\n      address: {\n        city,\n        country: \"fr\",\n        state: null,\n        line1: address,\n        line2: null,\n        postal_code: postalCode,\n      },\n      email: mail,\n      phone,\n    };\n\n    await stripe\n      .confirmCardPayment(data.clientSecret, {\n        payment_method: {\n          card: elements.getElement(CardElement),\n          billing_details,\n        },\n      })\n      .then((res) => {\n        setError(null);\n        setProcessing(false);\n        setDisabled(false);\n        setSucceeded(true);\n        registerDon();\n      })\n      .catch((err) => {\n        setError(`Paiement échoué: ${err.message}`);\n        setProcessing(false);\n        setSuccess(false);\n        handleShow();\n      });\n  };\n\n  return (\n    <div className=\"paiment\">\n      <div className=\"paiement__container\">\n        <h1>Paiement</h1>\n        <div className=\"paiement__process\">\n          <div\n            className={\n              \"paiement__process--option1 paiement__process--options active\"\n            }\n          >\n            <span>1</span>\n            <p>Adresse de facturation</p>\n          </div>\n          <hr />\n          <div\n            className={\n              \"paiement__process--option2 paiement__process--options \" +\n              (steps === 2 ? \"active\" : \"\")\n            }\n          >\n            <span>2</span>\n            <p>Détails de paiement</p>\n          </div>\n        </div>\n\n        {steps === 1 ? (\n          <form\n            noValidate\n            autoComplete=\"off\"\n            onSubmit={handleSubmit}\n            style={{ flexDirection: \"column\" }}\n          >\n            <FormControl\n              fullWidth\n              className={`${classes.margin} ${classes.border} `}\n            >\n              <InputLabel>Nom</InputLabel>\n              <Input\n                value={lastName}\n                name=\"lastName\"\n                onChange={handleInputChange}\n                required\n              />\n            </FormControl>\n            <div className=\"error\">{errors.lastName}</div>\n\n            <FormControl\n              fullWidth\n              className={`${classes.margin} ${classes.border} `}\n            >\n              <InputLabel>Prenom</InputLabel>\n              <Input\n                value={firstName}\n                name=\"firstName\"\n                onChange={handleInputChange}\n                required\n              />\n            </FormControl>\n            <div className=\"error\">{errors.firstName}</div>\n\n            <FormControl\n              fullWidth\n              className={`${classes.margin} ${classes.border} `}\n            >\n              <InputLabel>Adresse Mail</InputLabel>\n              <Input\n                type=\"email\"\n                name=\"mail\"\n                onChange={handleInputChange}\n                value={mail}\n                required\n              />\n            </FormControl>\n            <div className=\"error\">{errors.mail}</div>\n\n            <FormControl\n              fullWidth\n              className={`${classes.margin} ${classes.border} `}\n            >\n              <InputLabel>Numéro de Téléphone</InputLabel>\n              <Input\n                value={phone}\n                name=\"phone\"\n                onChange={handleInputChange}\n                required\n              />\n            </FormControl>\n            <div className=\"error\">{errors.phone}</div>\n\n            <FormControl\n              fullWidth\n              className={`${classes.margin} ${classes.border} `}\n            >\n              <InputLabel>Adresse</InputLabel>\n              <Input\n                value={address}\n                name=\"address\"\n                onChange={handleInputChange}\n                required\n              />\n            </FormControl>\n            <div className=\"error\">{errors.address}</div>\n\n            <div style={{ display: \"flex\" }}>\n              <FormControl\n                fullWidth\n                className={`${classes.margin} ${classes.border} ${classes.marginLeftRight}`}\n              >\n                <InputLabel>Ville</InputLabel>\n                <Input\n                  value={city}\n                  name=\"city\"\n                  onChange={handleInputChange}\n                  required\n                />\n                <div className=\"error\">{errors.city}</div>\n              </FormControl>\n              <FormControl\n                fullWidth\n                className={`${classes.margin} ${classes.border} ${classes.marginLeftRight}`}\n              >\n                <InputLabel>Code Postal</InputLabel>\n                <Input\n                  value={postalCode}\n                  name=\"postalCode\"\n                  onChange={handleInputChange}\n                  required\n                />\n                <div className=\"error\">{errors.postalCode}</div>\n              </FormControl>\n            </div>\n\n            <Button\n              type=\"submit\"\n              variant=\"contained\"\n              color=\"primary\"\n              className=\"paiement--btn\"\n              endIcon={<NavigateNextIcon />}\n            >\n              Suivant\n            </Button>\n          </form>\n        ) : (\n          <div className=\"paiement__details\">\n            <div className=\"paiement__details__recapitualitfs\">\n              <h2>Récapitulatif de don</h2>\n              <div className=\"paiement__details__recapitualitfs-total\">\n                <p>Montant</p>\n                <p className=\"paiement__details__recapitualitfs-total-prix\">\n                  {montant}€\n                </p>\n              </div>\n            </div>\n\n            <div className=\"paiement__details__modePaiement\">\n              <h2>Paiement sécurisé par carte bancaire</h2>\n              <p>CB et VISA acceptées</p>\n              <form className=\"paiement__form\">\n                <CardElement\n                  id=\"card-element\"\n                  onChange={handleChange}\n                  options={cardStyle}\n                />\n                {error && (\n                  <div className=\"paiement__details__error\">* {error}</div>\n                )}\n                <Button\n                  onClick={Payer}\n                  disabled={montant <= 1 || processing || disabled || succeeded}\n                  type=\"submit\"\n                  variant=\"contained\"\n                  color=\"primary\"\n                  className=\"paiement--btn-payer\"\n                >\n                  <span className=\"paiement--btn-payer-text\">\n                    {/* {processing ? (\n                        <img src={spinner} alt=\"spinner\" />\n                        ) : (\n                        <>Donner {montant}€</>\n                        )} */}\n                    Donner {montant}€\n                  </span>\n                </Button>\n              </form>\n              <p className=\"paiement__details__securise\">\n                <i className=\"fas fa-lock\"></i> Paiement 100% sécurisé\n              </p>\n            </div>\n          </div>\n        )}\n\n        <div className=\"paiement__back active\">\n          <IconButton\n            onClick={() => {\n              if (steps === 2) setSteps(1);\n              else setPayment(false);\n            }}\n          >\n            <i className=\"fas fa-arrow-left\"></i>\n          </IconButton>\n        </div>\n      </div>\n\n      <Modal\n        handleClose={handleClose}\n        show={show}\n        title={\n          <>\n            {success ? \"Envoyé\" : \"Erreur\"}\n            <i\n              className={`${\n                success ? \" fas fa-thumbs-up\" : \" fas fa-thumbs-down\"\n              }`}\n              style={{\n                color: \"var(--primary-color)\",\n                marginLeft: \"1rem\",\n              }}\n            ></i>\n          </>\n        }\n      >\n        {success ? dataRegister.donneur\n          ? \"Félicitations ! Nous avons bien reçu votre don et vous remercions.\"\n          : \"Une erreur s'est produite, veuillez réessayer.\"\n          ?  \"Félicitations ! Nous avons bien reçu votre adhésion et vous remercions.\"\n          : \"Une erreur s'est produite, veuillez réessayer.\" : \"\"\n        }\n\n        {/* \n        {success && dataRegister.donneur !== null\n          ? \"Félicitations ! Nous avons bien reçu votre don et vous remercions.\"\n          : \"Une erreur s'est produite, veuillez réessayer.\"}\n        {success && dataRegister.adherent !== null\n          ? \"Félicitations ! Nous avons bien reçu votre adhésion et vous remercions.\"\n          : \"Une erreur s'est produite, veuillez réessayer.\"}\n          */}\n      </Modal>\n    </div>\n  );\n};\nconst cardStyle = {\n  style: {\n    base: {\n      color: \"#32325d\",\n      fontFamily: \"Roboto, Open Sans, Segoe UI, sans-serif\",\n      fontSmoothing: \"antialiased\",\n      fontSize: \"16px\",\n      \"::placeholder\": {\n        color: \"#aaa\",\n        backgroundColor: \"#fff\",\n      },\n      \":-webkit-autofill\": {\n        color: \"#fff\",\n      },\n      \":focus\": {\n        color: \"#aaa\",\n      },\n    },\n\n    invalid: {\n      color: \"#fa755a\",\n      iconColor: \"#fa755a\",\n    },\n  },\n  hidePostalCode: true,\n};\n\nexport default Paiement;\n"]},"metadata":{},"sourceType":"module"}